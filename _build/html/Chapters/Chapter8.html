
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Introduction &#8212; Computational Physics  I (PHYS 3500K)</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Chapters/Chapter8';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Introduction" href="Chapter9.html" />
    <link rel="prev" title="Introduction" href="Chapter7.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
  
    <p class="title logo__title">Computational Physics  I (PHYS 3500K)</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Welcome to your Jupyter Book
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Chapter1.html">Making Computers Obey</a></li>






<li class="toctree-l1"><a class="reference internal" href="Chapter2.html">Computer Number Representations</a></li>

<li class="toctree-l1"><a class="reference internal" href="Chapter3.html">Deterministic Randomness</a></li>


<li class="toctree-l1"><a class="reference internal" href="Chapter4.html">Numerical Differentiation</a></li>



<li class="toctree-l1"><a class="reference internal" href="Chapter5.html">Introduction</a></li>


<li class="toctree-l1"><a class="reference internal" href="Chapter6.html">Trial-and-Error Root Finding</a></li>


<li class="toctree-l1"><a class="reference internal" href="Chapter7.html">Introduction</a></li>



<li class="toctree-l1 current active"><a class="current reference internal" href="#">Introduction</a></li>




<li class="toctree-l1"><a class="reference internal" href="Chapter9.html">Introduction</a></li>





<li class="toctree-l1"><a class="reference internal" href="Chapter10.html">Introduction</a></li>


</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FChapters/Chapter8.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/Chapters/Chapter8.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Introduction</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Introduction</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#the-importance-of-being-nonlinear">The Importance of being Nonlinear</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#flows-on-the-line">Flows on the Line</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fixed-points-and-stability">Fixed Points and Stability</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-8-1-find-all-the-fixed-points-for-dot-x-x-2-1-and-classify-their-stability">Example 8.1: Find all the fixed points for <span class="math notranslate nohighlight">\(\dot{x} = x^2 -1\)</span>, and classify their stability.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-stability-analysis">Linear Stability Analysis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-8-2-use-linearization-to-determine-the-stability-of-the-fixed-points-for-dot-x-sin-x">Example 8.2: Use linearization to determine the stability of the fixed points for <span class="math notranslate nohighlight">\(\dot{x} = \sin x\)</span>.</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#two-dimensional-systems">Two-Dimensional Systems</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#d-linear-systems">2D Linear Systems</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-8-3-analysis-of-the-simple-harmonic-oscillator">Example 8.3: Analysis of the Simple Harmonic Oscillator.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#classification-of-linear-systems">Classification of Linear Systems</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-8-4-solve-the-initial-value-problem-dot-x-x-y-dot-y-4-x-2y-with-initial-condition-x-0-y-0-2-3">Example 8.4: Solve the initial value problem <span class="math notranslate nohighlight">\(\dot{x} = x + y\)</span>, <span class="math notranslate nohighlight">\(\dot{y} = 4 x - 2y\)</span> with initial condition <span class="math notranslate nohighlight">\((x_0, y_0) = (2,-3)\)</span>.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-phase-plane-and-phase-portraits">The Phase Plane and Phase Portraits</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fixed-points-and-linearization">Fixed Points and Linearization</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-8-5-consider-the-system-dot-x-x-e-y-and-dot-y-y-first-use-qualitative-arguments-to-obtain-information-about-the-phase-portrait-then-use-the-runge-kutta-method-to-compute-several-trajectories-and-plot-them-on-the-phase-plane">Example 8.5: Consider the system <span class="math notranslate nohighlight">\(\dot{x} = x + e^{-y}\)</span> and <span class="math notranslate nohighlight">\(\dot{y} = -y\)</span>. First use qualitative arguments to obtain information about the phase portrait. Then, use the Runge-Kutta method to compute several trajectories, and plot them on the phase plane.</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#the-lorenz-equations-and-chaos">The Lorenz Equations and Chaos</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simple-properties-of-the-lorenz-equations">Simple Properties of the Lorenz Equations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-stability-of-the-origin">Linear Stability of the Origin</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-8-1-chaos-on-a-strange-attractor">Exercise 8.1: Chaos on a Strange Attractor</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-definition-of-chaos">The Definition of Chaos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lorenz-attractor-animation">Lorenz Attractor Animation</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><font size="6"> <strong>Chapter 8: An Introduction to Nonlinear Dynamics and Chaos</strong> </font></p>
<section class="tex2jax_ignore mathjax_ignore" id="introduction">
<h1>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h1>
<p>We have already had a glimpse at nonlinear systems, e.g. in the case of the pendulum without the small-angle approximation. The aim of this chapter is to provide a brief foray into some of the formal aspects of the analysis of dynamical nonlinear systems, while introducing concepts such as flows in phase space, fixed points, linearization, and chaotic systems.</p>
<p>All of these concepts are part of the subject of dynamics, i.e. the study of systems that evolve in time.</p>
<p>We will use the computational knowledge we have gained thus far to obtain a quantitative understanding of some simple systems.</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="the-importance-of-being-nonlinear">
<h1>The Importance of being Nonlinear<a class="headerlink" href="#the-importance-of-being-nonlinear" title="Link to this heading">#</a></h1>
<p>There are two types of dynamical systems: differential equations and iterated maps (or difference equations). Here we will study differential equations, since we already have the machinery developed to solve them, even in their nonlinear form.</p>
<p>Why are nonlinear problems harder to solve than linear ones?</p>
<p>The answer lies in the fact that linear systems can be broken down into parts. Each part can be solved sparately and finally recombined to get an answer. This allows for fantastic simplification of complex problems, and underlies methods such as normal modes, Laplace transforms, superposition arguments, and Fourier analysis.</p>
<p>A linear system is precisely equal to the sum of its parts!</p>
<p>But many things in nature don’t act this way, e.g. whenever parts of a system interfere, or cooperate, or compete, there are nonlinear interactions going on.</p>
<p>Most of everyday life is nonlinear and the principle of superposition fails spectacularly!</p>
<p>Within the realm of physics, nonlinearity is vital to the operation of a laser, the formation of turbulence in a fluid, and the superconductivity of Josephson junctions.</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="flows-on-the-line">
<h1>Flows on the Line<a class="headerlink" href="#flows-on-the-line" title="Link to this heading">#</a></h1>
<section id="fixed-points-and-stability">
<h2>Fixed Points and Stability<a class="headerlink" href="#fixed-points-and-stability" title="Link to this heading">#</a></h2>
<p>Let’s start by examining a one-dimensional, or first-order system, described by a differential equation of the form:</p>
<p><span class="math notranslate nohighlight">\(\dot{x} = f(x)\)</span>,</p>
<p>where, as usual, <span class="math notranslate nohighlight">\(\dot{~} \equiv \mathrm{d}/\mathrm{d}t\)</span>.</p>
<p>Pictures are often more helpful than formulas when analyzing a nonlinear system.</p>
<p>Consider <span class="math notranslate nohighlight">\(\dot{x} = \sin x\)</span>. The general solution is:</p>
<p><span class="math notranslate nohighlight">\(t = - \ln | \csc x + \cot x | + C\)</span>.</p>
<p>If the initial condition is <span class="math notranslate nohighlight">\(x=x_0\)</span> at <span class="math notranslate nohighlight">\(t=0\)</span>, then:</p>
<p><span class="math notranslate nohighlight">\(x = \ln \left| \frac{ \csc x_0 + \cot x_0 }{\csc x + \cot x} \right|\)</span>.</p>
<p>The result is exact, but it is a headache to interpret!</p>
<p>In contrast, a graphical analysis is clear and simple.</p>
<p>Think of <span class="math notranslate nohighlight">\(t\)</span> as time, <span class="math notranslate nohighlight">\(x\)</span> as the position of an imaginary particle moving along the real line (i.e. left or right), and <span class="math notranslate nohighlight">\(\dot{x}\)</span> the velocity of the particle.</p>
<p><span class="math notranslate nohighlight">\(\dot{x} = f(x)\)</span> represents a <em>vector field</em> along the line. The differential equation dictates the velocity <span class="math notranslate nohighlight">\(\dot{x}\)</span> at each <span class="math notranslate nohighlight">\(x\)</span>.</p>
<p>To sketch the vector field, it is convenient to plot <span class="math notranslate nohighlight">\(\dot{x}\)</span> versus <span class="math notranslate nohighlight">\(x\)</span>, then draw arrows on the <span class="math notranslate nohighlight">\(x\)</span>-axis to indicate the corresponding velocity vector <span class="math notranslate nohighlight">\(\dot{x}\)</span> at each <span class="math notranslate nohighlight">\(x\)</span>.</p>
<p>Arrows would point to the right when <span class="math notranslate nohighlight">\(\dot{x} &gt; 0\)</span> and to the left when <span class="math notranslate nohighlight">\(\dot{x} &lt; 0\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span> <span class="c1"># import matplotlib, a conventional module name is plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span> <span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">+</span><span class="mf">0.2</span><span class="p">,</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mi">600</span><span class="p">)</span> <span class="c1"># </span>
<span class="n">xdot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> 

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span> <span class="c1"># create the elements required for matplotlib. This creates a figure containing a single axes.</span>

<span class="c1"># set the labels and titles:</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> <span class="c1"># set the x label</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\dot</span><span class="si">{x}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> <span class="c1"># set the y label</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;A vector field on the line&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span> <span class="c1"># set the title </span>

<span class="c1"># set the x and y limits:</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">+</span><span class="mf">0.2</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">-</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span><span class="mf">1.1</span><span class="p">)</span>

<span class="c1"># make one-dimensional plots using the above arrays, add a custom label, linestyles and colors:</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">xdot</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;a sine curve&#39;</span><span class="p">)</span> 

<span class="c1"># change the axis labels to correspond to [0, pi/2, pi, 1.5 * pi, 2*pi, 2.5*pi, 3*pi]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mf">2.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="s1">&#39;$-3</span><span class="se">\\</span><span class="s1">pi$&#39;</span><span class="p">,</span><span class="s1">&#39;$5</span><span class="se">\\</span><span class="s1">pi/2$&#39;</span><span class="p">,</span> <span class="s1">&#39;$-2</span><span class="se">\\</span><span class="s1">pi$&#39;</span><span class="p">,</span> <span class="s1">&#39;$-3</span><span class="se">\\</span><span class="s1">pi/2$&#39;</span><span class="p">,</span> <span class="s1">&#39;$-</span><span class="se">\\</span><span class="s1">pi$&#39;</span><span class="p">,</span><span class="s1">&#39;$-</span><span class="se">\\</span><span class="s1">pi/2$&#39;</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">pi/2$&#39;</span><span class="p">,</span> <span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">pi$&#39;</span><span class="p">,</span> <span class="s1">&#39;$3</span><span class="se">\\</span><span class="s1">pi/2$&#39;</span><span class="p">,</span> <span class="s1">&#39;$2</span><span class="se">\\</span><span class="s1">pi$&#39;</span><span class="p">,</span> <span class="s1">&#39;$5</span><span class="se">\\</span><span class="s1">pi/2$&#39;</span><span class="p">,</span> <span class="s1">&#39;$3</span><span class="se">\\</span><span class="s1">pi$&#39;</span><span class="p">])</span>

<span class="c1"># plot the fixed points: </span>
<span class="n">xfpu</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">]</span>
<span class="n">yfpu</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xfpu</span><span class="p">,</span> <span class="n">yfpu</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">facecolors</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>

<span class="c1"># plot the fixed points: </span>
<span class="n">xfps</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">]</span>
<span class="n">yfps</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xfps</span><span class="p">,</span> <span class="n">yfps</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">facecolors</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>


<span class="c1"># the axes:</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

<span class="c1"># Vector origin location </span>
<span class="n">X</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">]</span> 
<span class="n">Y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> 
  
<span class="c1"># Directional vectors </span>
<span class="n">U</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="mf">0.1</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="mf">0.1</span><span class="p">]</span>   
<span class="n">V</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>   
<span class="c1"># Creating plot </span>
<span class="n">plt</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.08</span><span class="p">)</span> 

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> <span class="c1"># show the plot here</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/379a593f715c6b7ad5a6351c3180c4045a8e10242276c65092b6f23c4e214e8f.png" src="../_images/379a593f715c6b7ad5a6351c3180c4045a8e10242276c65092b6f23c4e214e8f.png" />
</div>
</div>
<p>A more physical way to think of the vector field: imagine that a fluid is flowing steadily along the <span class="math notranslate nohighlight">\(x\)</span>-axis with a velocity that varies from place to place, according to <span class="math notranslate nohighlight">\(\dot{x} = \sin x\)</span>. The flow is to the right when <span class="math notranslate nohighlight">\(\dot{x} &gt; 0\)</span> and to the left when <span class="math notranslate nohighlight">\(\dot{x} &lt; 0\)</span>.</p>
<p>At points where <span class="math notranslate nohighlight">\(\dot{x} =0\)</span>, there is no flow! These are the <em>fixed points</em>.</p>
<p>From the graph, we can see that there are two kinds of fixed points: solid dots represent <em>stable fixed points</em>, often called attractors or sinks, because the flow is toward them. Open circles represent unstable fixed points, also called repellers or sources.</p>
<p>Armed with this picture, we can easily understand the solutions of the differential equation <span class="math notranslate nohighlight">\(\dot{x} = \sin x\)</span> qualitatively:</p>
<p>We start an imaginary particle at <span class="math notranslate nohighlight">\(x_0\)</span> and watch how it is carried along by the flow. E.g. a particle starting at <span class="math notranslate nohighlight">\(x_0 = \pi/4\)</span> moves to the right faster and faster until it crosses <span class="math notranslate nohighlight">\(\pi/2\)</span>, where <span class="math notranslate nohighlight">\(\sin x\)</span> reaches its maximum, and eventually approaches the stable fixed point <span class="math notranslate nohighlight">\(x=\pi\)</span> from the left:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span> <span class="c1"># import matplotlib, a conventional module name is plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="o">+</span><span class="mf">0.00000001</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">-</span><span class="mf">0.000001</span><span class="p">,</span> <span class="mi">600</span><span class="p">)</span> 
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="p">)</span> <span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span> <span class="c1"># create the elements required for matplotlib. This creates a figure containing a single axes.</span>

<span class="c1"># set the labels and titles:</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$t$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> <span class="c1"># set the x label</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> <span class="c1"># set the y label</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Evolution of $x_0=</span><span class="se">\\</span><span class="s1">pi/4$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span> <span class="c1"># set the title </span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;a sine curve&#39;</span><span class="p">)</span> 

<span class="c1"># change the axis ticks, labels, and aspect</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">pi/4$&#39;</span><span class="p">,</span> <span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">pi$&#39;</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># the axes:</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> <span class="c1"># show the plot here</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/5a726a6ea5a1129171d246c6c0555d40707b762a819452b2b86e25b19a1f5e78.png" src="../_images/5a726a6ea5a1129171d246c6c0555d40707b762a819452b2b86e25b19a1f5e78.png" />
</div>
</div>
<p>A picture cannot tell us certain quantitative things, but can still give us a good understanding of the physical situation. We can then use numerical methods to understand the solutions quantitatively.</p>
<p>The ideas can be extended to any one-dimensional system of the form <span class="math notranslate nohighlight">\(\dot{x} = f(x)\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span> <span class="c1"># import matplotlib, a conventional module name is plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">600</span><span class="p">)</span> <span class="c1"># </span>
<span class="n">xdot</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span> <span class="c1"># create the elements required for matplotlib. This creates a figure containing a single axes.</span>

<span class="c1"># set the labels and titles:</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> <span class="c1"># set the x label</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\dot</span><span class="si">{x}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> <span class="c1"># set the y label</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;A vector field on the line&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span> <span class="c1"># set the title </span>

<span class="c1"># set the x and y limits:</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>

<span class="c1"># make one-dimensional plots using the above arrays, add a custom label, linestyles and colors:</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">xdot</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;a sine curve&#39;</span><span class="p">)</span> 

<span class="c1"># change the axis labels to correspond to [0, pi/2, pi, 1.5 * pi, 2*pi, 2.5*pi, 3*pi]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>

<span class="c1"># plot the fixed points: </span>
<span class="n">xfpu</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.5396</span><span class="p">]</span>
<span class="n">yfpu</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xfpu</span><span class="p">,</span> <span class="n">yfpu</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">facecolors</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>

<span class="c1"># plot the fixed points: </span>
<span class="n">xfps</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.32941</span><span class="p">]</span>
<span class="n">yfps</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xfps</span><span class="p">,</span> <span class="n">yfps</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">facecolors</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>


<span class="c1"># the axes:</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

<span class="c1"># Vector origin location </span>
<span class="n">X</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.5396</span><span class="p">,</span> <span class="mf">1.539</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.32941</span><span class="o">-</span><span class="mf">0.8</span><span class="p">]</span> 
<span class="n">Y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> 
  
<span class="c1"># Directional vectors </span>
<span class="n">U</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.32941</span><span class="o">+</span><span class="mf">0.9</span><span class="p">]</span>   
<span class="n">V</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">]</span>   
<span class="c1"># Creating plot </span>
<span class="n">plt</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.035</span><span class="p">)</span> 

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> <span class="c1"># show the plot here</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/17cf8df9919643d8ec9a946b3cae6ce3fc0198a8338d486bb81bf061f344e2be.png" src="../_images/17cf8df9919643d8ec9a946b3cae6ce3fc0198a8338d486bb81bf061f344e2be.png" />
</div>
</div>
<p>This imaginary fluid is called the <em>phase fluid</em>, and the real line is the <em>phase space</em>.</p>
<p>To find a solution to <span class="math notranslate nohighlight">\(\dot{x} = f(x)\)</span> starting from an arbitrary initial condition <span class="math notranslate nohighlight">\(x_0\)</span>, we place an imaginary particle (a <em>phase point</em>) at <span class="math notranslate nohighlight">\(x_0\)</span> and watch how it is carried along by the flow. As time goes on, the phase point moves along the <span class="math notranslate nohighlight">\(x\)</span>-axis according to some function <span class="math notranslate nohighlight">\(x(t)\)</span>. This function is called the <em>trajectory</em> based at <span class="math notranslate nohighlight">\(x_0\)</span>, and it represents the solution to the differential equation starting from <span class="math notranslate nohighlight">\(x_0\)</span>. A picture like the one above, which shows qualitatively all the trajectories of the system, is called a <em>phase portrait</em>.</p>
<p>The appearance of the phase portrait is controlled by the fixed points <span class="math notranslate nohighlight">\(x^*\)</span>, defined by <span class="math notranslate nohighlight">\(f(x^*)=0\)</span>. These are stagnation points of the flow. Solid dots are stable fixed points (the local flow is towards them), and open dots are unstable fixed points (the flow is away from them).</p>
<p>In terms of the differential equation, the fixed points represent equilibrium solutions. An equlibrium is defined to be stable if all sufficiently small disturbances away from it damp out in time. Conversely, unstable equilibria, which disturbances grow in time, are represented by unstable fixed points.</p>
</section>
<section id="example-8-1-find-all-the-fixed-points-for-dot-x-x-2-1-and-classify-their-stability">
<h2>Example 8.1: Find all the fixed points for <span class="math notranslate nohighlight">\(\dot{x} = x^2 -1\)</span>, and classify their stability.<a class="headerlink" href="#example-8-1-find-all-the-fixed-points-for-dot-x-x-2-1-and-classify-their-stability" title="Link to this heading">#</a></h2>
<p>We note here that the definition of stable equilibrium is based on <em>small</em> disturbances: large disturbances may fail to decay. To emphasize this aspect of stability, we may characterize a fixed point as <em>locally stable</em> and not globally stable.</p>
</section>
<section id="linear-stability-analysis">
<h2>Linear Stability Analysis<a class="headerlink" href="#linear-stability-analysis" title="Link to this heading">#</a></h2>
<p>We would like to have a more quantitative measure of stability, such as the rate of decay to a stable fixed point. To achieve this, we <em>linearize</em> about a fixed point.</p>
<p>Let <span class="math notranslate nohighlight">\(x^*\)</span> be a fixed point and consider a small perturbation <span class="math notranslate nohighlight">\(\eta(t)\)</span> away from <span class="math notranslate nohighlight">\(x^*\)</span>: <span class="math notranslate nohighlight">\(x(t) = x^* + \eta(t)\)</span>. Evidently, since <span class="math notranslate nohighlight">\(x^*\)</span> is a constant:</p>
<p><span class="math notranslate nohighlight">\(\dot{\eta} = \dot{x}\)</span>, and so: <span class="math notranslate nohighlight">\(\dot{\eta} = f(x) = f(x^* + \eta)\)</span>.</p>
<p>If we now Taylor-expand the right-hand side:</p>
<p><span class="math notranslate nohighlight">\(\dot{\eta} = f(x^*) + \eta f'(x^*) + \mathcal{O}(\eta^2)\)</span>,</p>
<p>where <span class="math notranslate nohighlight">\(' \equiv \mathrm{d}/\mathrm{d}x\)</span>.</p>
<p>Since <span class="math notranslate nohighlight">\(f(x^*) = 0\)</span> for the fixed point <span class="math notranslate nohighlight">\(x^*\)</span>, and neglecting the terms <span class="math notranslate nohighlight">\(\mathcal{O}(\eta^2)\)</span>, we have:</p>
<p><span class="math notranslate nohighlight">\(\dot{\eta} \approx \eta f'(x^*)\)</span>.</p>
<p>This is a linear equation in <span class="math notranslate nohighlight">\(\eta\)</span>, known as the <em>linearization</em> about <span class="math notranslate nohighlight">\(x^*\)</span>. It shows that the perturbation grows exponentially if <span class="math notranslate nohighlight">\(f'(x^*) &gt; 0\)</span>, and decays if <span class="math notranslate nohighlight">\(f'(x^*) &lt; 0\)</span>, since:</p>
<p><span class="math notranslate nohighlight">\(\eta(t) \approx \eta(0) \exp( f'(x^*) t)\)</span>.</p>
<p>Therefore, the slope, <span class="math notranslate nohighlight">\(f'(x^*)\)</span> at the fixed point determines its stability.</p>
<p>The value <span class="math notranslate nohighlight">\(|1/f'(x^*)|\)</span> is a characteristic time scale, and determines the time required for <span class="math notranslate nohighlight">\(x(t)\)</span> to vary significantly in the neighborhood of <span class="math notranslate nohighlight">\(x^*\)</span>.</p>
</section>
<section id="example-8-2-use-linearization-to-determine-the-stability-of-the-fixed-points-for-dot-x-sin-x">
<h2>Example 8.2: Use linearization to determine the stability of the fixed points for <span class="math notranslate nohighlight">\(\dot{x} = \sin x\)</span>.<a class="headerlink" href="#example-8-2-use-linearization-to-determine-the-stability-of-the-fixed-points-for-dot-x-sin-x" title="Link to this heading">#</a></h2>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="two-dimensional-systems">
<h1>Two-Dimensional Systems<a class="headerlink" href="#two-dimensional-systems" title="Link to this heading">#</a></h1>
<p>Let’s now consider the simplest class of a higher-dimensional system, one in two dimensions (2D). We will start with <em>linear</em> systems, which are interesting in their own right, but play an important role in the classification of fixed points of nonlinear systems.</p>
<section id="d-linear-systems">
<h2>2D Linear Systems<a class="headerlink" href="#d-linear-systems" title="Link to this heading">#</a></h2>
<p>A 2D linear system is defined by:</p>
<p><span class="math notranslate nohighlight">\(\dot{x} = a x + b y\)</span>,</p>
<p><span class="math notranslate nohighlight">\(\dot{y} = c x + d y\)</span>.</p>
<p>This can be written compactly in matrix form as:</p>
<p><span class="math notranslate nohighlight">\(\mathbf{\dot{x}} = A \mathbf{x}\)</span>,</p>
<p>where <span class="math notranslate nohighlight">\(\mathbf{x} = \left(\matrix{x\\y}\right)\)</span>, and <span class="math notranslate nohighlight">\(A = \left(\matrix{a &amp; b\\ c &amp; d}\right)\)</span>.</p>
<p>In this case, <span class="math notranslate nohighlight">\(\mathbf{\dot{x}} = \mathbf{0}\)</span> when <span class="math notranslate nohighlight">\(\mathbf{x} = \mathbf{0}\)</span>, and therefore <span class="math notranslate nohighlight">\(\mathbf{x}^* = \mathbf{0}\)</span> for any choice of <span class="math notranslate nohighlight">\(A\)</span>.</p>
<p>The solutions of <span class="math notranslate nohighlight">\(\mathbf{\dot{x}} = A \mathbf{x}\)</span> can be visualized as trajectories moving on the <span class="math notranslate nohighlight">\((x,y)\)</span> plane, in this context called the <em>phase plane</em>.</p>
</section>
<section id="example-8-3-analysis-of-the-simple-harmonic-oscillator">
<h2>Example 8.3: Analysis of the Simple Harmonic Oscillator.<a class="headerlink" href="#example-8-3-analysis-of-the-simple-harmonic-oscillator" title="Link to this heading">#</a></h2>
<p>Vibrations of a mass hanging from a linear spring are governed by the linear differential equation:</p>
<p><span class="math notranslate nohighlight">\(m \ddot{x} + kx = 0\)</span>, where <span class="math notranslate nohighlight">\(m\)</span> is the mass, <span class="math notranslate nohighlight">\(k\)</span> is the spring constant, and <span class="math notranslate nohighlight">\(x\)</span> is the displacement of the mass from equilibrium.</p>
<p>Give a phase plane analysis of this simple harmonic oscillator.</p>
</section>
<section id="classification-of-linear-systems">
<h2>Classification of Linear Systems<a class="headerlink" href="#classification-of-linear-systems" title="Link to this heading">#</a></h2>
<p>Let’s discuss a more general approach of the classification of linear systems, by examining an example system:</p>
<p><span class="math notranslate nohighlight">\(\mathbf{\dot{x}} = A \mathbf{x}\)</span>,</p>
<p>where: <span class="math notranslate nohighlight">\(A = \left(\matrix{a &amp; 0\\ 0 &amp; -1}\right)\)</span>.</p>
<p>Multiplying out:</p>
<p><span class="math notranslate nohighlight">\(\dot{x} = ax\)</span>,</p>
<p><span class="math notranslate nohighlight">\(\dot{y} = -y\)</span>.</p>
<p>Therefore, the equations are <em>uncoupled</em>: there’s no <span class="math notranslate nohighlight">\(x\)</span> in the <span class="math notranslate nohighlight">\(y\)</span>-equation and vice versa. In this simple case, the equation may be solved separately:</p>
<p><span class="math notranslate nohighlight">\(x(t) = x_0 e^{at}\)</span>,</p>
<p><span class="math notranslate nohighlight">\(y(t) = y_0 e^{-t}\)</span>.</p>
<p>The phase portraits are shown below for different values of the parameter <span class="math notranslate nohighlight">\(a\)</span>. In each case, <span class="math notranslate nohighlight">\(y(t)\)</span> decays exponentially. When <span class="math notranslate nohighlight">\(a&lt;0\)</span>, <span class="math notranslate nohighlight">\(x(t)\)</span> also decays exponentially, and so all trajectories approach the origin as <span class="math notranslate nohighlight">\(t\rightarrow \infty\)</span>. However, the direction of approach depends on the size of <span class="math notranslate nohighlight">\(a\)</span> compared to -1.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span> <span class="c1"># import matplotlib, a conventional module name is plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># the parameter a:</span>
<span class="n">a</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>

<span class="c1"># the initial condition combinations: </span>
<span class="n">x0</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">]</span>
<span class="n">y0</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>



<span class="c1">#t = np.concatenate((np.linspace(-2, -0.1,100),np.geomspace(-0.1, 1E-6, 1000)))</span>
<span class="c1">#t = np.concatenate((t,np.geomspace(1E-6, 0.1, 1000)))</span>
<span class="c1">#t = np.concatenate((t,np.linspace(-2, 2,100)))</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">xz</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">xz</span> <span class="ow">in</span> <span class="n">x0</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="n">yz</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">yz</span> <span class="ow">in</span> <span class="n">y0</span><span class="p">]</span>



<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span> <span class="c1"># create the elements required for matplotlib. This creates a figure containing a single axes.</span>

<span class="c1"># set the labels and titles:</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> <span class="c1"># set the x label</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$y$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> <span class="c1"># set the y label</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$a&lt;-1$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span> <span class="c1"># set the title </span>

<span class="c1"># set the x and y limits:</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">2.0</span><span class="p">,</span><span class="mf">2.0</span><span class="p">)</span>

<span class="c1"># make one-dimensional plots using the above arrays, add a custom label, linestyles and colors:</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
    <span class="n">a1</span> <span class="o">=</span> <span class="mi">80</span>
    <span class="n">fac</span> <span class="o">=</span> <span class="mf">0.06</span>
    <span class="n">fac2</span> <span class="o">=</span> <span class="mf">0.045</span>
    <span class="n">wa</span> <span class="o">=</span> <span class="mf">0.04</span>
    <span class="c1">#print(x[i][a1], y[i][a1])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">a1</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">a1</span><span class="p">],</span> <span class="n">fac</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">x0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span> <span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">x0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">y0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="p">,</span> <span class="o">-</span><span class="n">fac2</span><span class="o">*</span><span class="n">y0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span> <span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">x0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">y0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">wa</span><span class="p">)</span> 


<span class="c1"># change the axis labels to correspond to [0, pi/2, pi, 1.5 * pi, 2*pi, 2.5*pi, 3*pi]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>

<span class="c1"># plot the fixed points: </span>
<span class="c1">#xfpu = [1]</span>
<span class="c1">#yfpu = [0]</span>
<span class="c1">#plt.scatter(xfpu, yfpu, s=80, facecolors=&#39;none&#39;, edgecolors=&#39;r&#39;, zorder=11)</span>

<span class="c1"># plot the fixed points: </span>
<span class="n">xfps</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">yfps</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xfps</span><span class="p">,</span> <span class="n">yfps</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">facecolors</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>


<span class="c1"># the axes:</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mf">0.08</span><span class="p">)</span>
<span class="c1">#ax.axhline(y=0, color=&#39;k&#39;, alpha=0.5)</span>
<span class="c1">#ax.axvline(x=0, color=&#39;k&#39;)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> <span class="c1"># show the plot here</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/e7bccabcd7e9ae3be8e70aef6a71c9f52b226508851c8581cc37e7d6d1157798.png" src="../_images/e7bccabcd7e9ae3be8e70aef6a71c9f52b226508851c8581cc37e7d6d1157798.png" />
</div>
</div>
<p>For <span class="math notranslate nohighlight">\(a&lt;-1\)</span>, <span class="math notranslate nohighlight">\(x(t)\)</span> decays more rapidly than <span class="math notranslate nohighlight">\(y(t)\)</span>. The trajectories approach the origin tangent to the slower direction. <span class="math notranslate nohighlight">\(\mathbf{x}^* = \mathbf{0}\)</span> is a <em>stable node</em>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span> <span class="c1"># import matplotlib, a conventional module name is plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># the parameter a:</span>
<span class="n">a</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

<span class="c1"># the initial condition combinations: </span>
<span class="n">x0</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">]</span>
<span class="n">y0</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">xz</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">xz</span> <span class="ow">in</span> <span class="n">x0</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="n">yz</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">yz</span> <span class="ow">in</span> <span class="n">y0</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span> <span class="c1"># create the elements required for matplotlib. This creates a figure containing a single axes.</span>

<span class="c1"># set the labels and titles:</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> <span class="c1"># set the x label</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$y$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> <span class="c1"># set the y label</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$a=-1$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span> <span class="c1"># set the title </span>

<span class="c1"># set the x and y limits:</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># make one-dimensional plots using the above arrays, add a custom label, linestyles and colors:</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x0</span><span class="p">)):</span>
    <span class="n">a1</span> <span class="o">=</span> <span class="mi">85</span>
    <span class="n">fac</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">wa</span> <span class="o">=</span> <span class="mf">0.005</span>
    <span class="c1">#print(x[i][a1], y[i][a1])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">a1</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">a1</span><span class="p">],</span> <span class="n">fac</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">a1</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">a1</span><span class="p">]),</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">a1</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">a1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">wa</span><span class="p">)</span> 


<span class="c1"># change the axis labels to correspond to [0, pi/2, pi, 1.5 * pi, 2*pi, 2.5*pi, 3*pi]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>

<span class="c1"># plot the fixed points: </span>
<span class="c1">#xfpu = [1]</span>
<span class="c1">#yfpu = [0]</span>
<span class="c1">#plt.scatter(xfpu, yfpu, s=80, facecolors=&#39;none&#39;, edgecolors=&#39;r&#39;, zorder=11)</span>

<span class="c1"># plot the fixed points: </span>
<span class="n">xfps</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">yfps</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xfps</span><span class="p">,</span> <span class="n">yfps</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">facecolors</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>


<span class="c1"># the axes:</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
<span class="c1">#ax.axhline(y=0, color=&#39;k&#39;, alpha=0.5)</span>
<span class="c1">#ax.axvline(x=0, color=&#39;k&#39;)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> <span class="c1"># show the plot here</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/32a98c1d4afc202ee6cc4d05c6371db10b7c82c2729488799ef8d7d3bfb358e6.png" src="../_images/32a98c1d4afc202ee6cc4d05c6371db10b7c82c2729488799ef8d7d3bfb358e6.png" />
</div>
</div>
<p>When <span class="math notranslate nohighlight">\(a=-1\)</span>, all trajectories are straight lines through the origin. This occurs because the decay rates in the two directions are precisely equal. In this case <span class="math notranslate nohighlight">\(\mathbf{x}^*\)</span> is called a symmetrical node or a <em>star</em>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span> <span class="c1"># import matplotlib, a conventional module name is plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># the parameter a:</span>
<span class="n">a</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.8</span>

<span class="c1"># the initial condition combinations: </span>
<span class="n">x0</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">y0</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="o">-</span><span class="mi">20</span><span class="p">]</span>



<span class="c1">#t = np.concatenate((np.linspace(-2, -0.1,100),np.geomspace(-0.1, 1E-6, 1000)))</span>
<span class="c1">#t = np.concatenate((t,np.geomspace(1E-6, 0.1, 1000)))</span>
<span class="c1">#t = np.concatenate((t,np.linspace(-2, 2,100)))</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">xz</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">xz</span> <span class="ow">in</span> <span class="n">x0</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="n">yz</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">yz</span> <span class="ow">in</span> <span class="n">y0</span><span class="p">]</span>



<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span> <span class="c1"># create the elements required for matplotlib. This creates a figure containing a single axes.</span>

<span class="c1"># set the labels and titles:</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> <span class="c1"># set the x label</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$y$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> <span class="c1"># set the y label</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$-1&lt;a&lt;0$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span> <span class="c1"># set the title </span>

<span class="c1"># set the x and y limits:</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">2.0</span><span class="p">,</span><span class="mf">2.0</span><span class="p">)</span>

<span class="c1"># make one-dimensional plots using the above arrays, add a custom label, linestyles and colors:</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
    <span class="n">a1</span> <span class="o">=</span> <span class="mi">92</span>
    <span class="n">fac</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">fac2</span> <span class="o">=</span> <span class="mf">1.5</span>
    <span class="n">wa</span> <span class="o">=</span> <span class="mf">0.02</span>
    <span class="c1">#print(x[i][a1], y[i][a1])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">a1</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">a1</span><span class="p">],</span> <span class="n">fac</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">a1</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">a1</span><span class="p">]),</span> <span class="n">fac2</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">a1</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">a1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">wa</span><span class="p">)</span> 

<span class="c1"># change the axis labels to correspond to [0, pi/2, pi, 1.5 * pi, 2*pi, 2.5*pi, 3*pi]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>

<span class="c1"># plot the fixed points: </span>
<span class="c1">#xfpu = [1]</span>
<span class="c1">#yfpu = [0]</span>
<span class="c1">#plt.scatter(xfpu, yfpu, s=80, facecolors=&#39;none&#39;, edgecolors=&#39;r&#39;, zorder=11)</span>

<span class="c1"># plot the fixed points: </span>
<span class="n">xfps</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">yfps</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xfps</span><span class="p">,</span> <span class="n">yfps</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">facecolors</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>


<span class="c1"># the axes:</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mf">0.08</span><span class="p">)</span>
<span class="c1">#ax.axhline(y=0, color=&#39;k&#39;, alpha=0.5)</span>
<span class="c1">#ax.axvline(x=0, color=&#39;k&#39;)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> <span class="c1"># show the plot here</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/18f94370618aae35cc7805f458f526a4ddf60b8cc253bd0fba4fdb9422eb6c77.png" src="../_images/18f94370618aae35cc7805f458f526a4ddf60b8cc253bd0fba4fdb9422eb6c77.png" />
</div>
</div>
<p>When <span class="math notranslate nohighlight">\(-1 &lt; a &lt; 0\)</span>, we again have a stable node, but now the trajectories approach <span class="math notranslate nohighlight">\(\mathbf{x}^*\)</span> along the <span class="math notranslate nohighlight">\(x\)</span>-direction, which is the more slowly decaying direction.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span> <span class="c1"># import matplotlib, a conventional module name is plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># the parameter a:</span>
<span class="n">a</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># the initial condition combinations: </span>
<span class="n">x0</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">y0</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="o">-</span><span class="mi">20</span><span class="p">]</span>

<span class="c1">#t = np.concatenate((np.linspace(-2, -0.1,100),np.geomspace(-0.1, 1E-6, 1000)))</span>
<span class="c1">#t = np.concatenate((t,np.geomspace(1E-6, 0.1, 1000)))</span>
<span class="c1">#t = np.concatenate((t,np.linspace(-2, 2,100)))</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">xz</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">xz</span> <span class="ow">in</span> <span class="n">x0</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="n">yz</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">yz</span> <span class="ow">in</span> <span class="n">y0</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span> <span class="c1"># create the elements required for matplotlib. This creates a figure containing a single axes.</span>

<span class="c1"># set the labels and titles:</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> <span class="c1"># set the x label</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$y$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> <span class="c1"># set the y label</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$a=0$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span> <span class="c1"># set the title </span>

<span class="c1"># set the x and y limits:</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">2.0</span><span class="p">,</span><span class="mf">2.0</span><span class="p">)</span>

<span class="c1"># make one-dimensional plots using the above arrays, add a custom label, linestyles and colors:</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
    <span class="n">a1</span> <span class="o">=</span> <span class="mi">87</span>
    <span class="n">fac</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">fac2</span> <span class="o">=</span> <span class="mf">1.5</span>
    <span class="n">wa</span> <span class="o">=</span> <span class="mf">0.02</span>
    <span class="c1">#print(x[i][a1], y[i][a1])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">a1</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">a1</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="n">fac2</span><span class="o">*</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">a1</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">a1</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">wa</span><span class="p">)</span> 

<span class="c1"># change the axis labels to correspond to [0, pi/2, pi, 1.5 * pi, 2*pi, 2.5*pi, 3*pi]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>

<span class="c1"># plot the fixed points: </span>
<span class="c1">#xfpu = [1]</span>
<span class="c1">#yfpu = [0]</span>
<span class="c1">#plt.scatter(xfpu, yfpu, s=80, facecolors=&#39;none&#39;, edgecolors=&#39;r&#39;, zorder=11)</span>

<span class="c1"># plot the fixed points: </span>
<span class="n">xfps</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">yfps</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xfps</span><span class="p">,</span> <span class="n">yfps</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">facecolors</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>


<span class="c1"># the axes:</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="c1">#ax.axvline(x=0, color=&#39;k&#39;)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> <span class="c1"># show the plot here</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/9e136ec66df6d6f2ca9f4f65a3ff04fa2d35bcaa582571ab502f5897e116798d.png" src="../_images/9e136ec66df6d6f2ca9f4f65a3ff04fa2d35bcaa582571ab502f5897e116798d.png" />
</div>
</div>
<p>Something dramatic happens when <span class="math notranslate nohighlight">\(a=0\)</span>: there’s an <em>entire line</em> of fixed points along the <span class="math notranslate nohighlight">\(x\)</span>-axis. All trajectories approach these fixed points along vertical lines.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span> <span class="c1"># import matplotlib, a conventional module name is plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># the parameter a:</span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">1.5</span>

<span class="c1"># the initial condition combinations: </span>
<span class="n">x0</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">]</span>
<span class="n">y0</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="c1">#t = np.concatenate((np.linspace(-2, -0.1,100),np.geomspace(-0.1, 1E-6, 1000)))</span>
<span class="c1">#t = np.concatenate((t,np.geomspace(1E-6, 0.1, 1000)))</span>
<span class="c1">#t = np.concatenate((t,np.linspace(-2, 2,100)))</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">xz</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">xz</span> <span class="ow">in</span> <span class="n">x0</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="n">yz</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">yz</span> <span class="ow">in</span> <span class="n">y0</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span> <span class="c1"># create the elements required for matplotlib. This creates a figure containing a single axes.</span>

<span class="c1"># set the labels and titles:</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> <span class="c1"># set the x label</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$y$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> <span class="c1"># set the y label</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$a&gt;0$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span> <span class="c1"># set the title </span>

<span class="c1"># set the x and y limits:</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">5.0</span><span class="p">,</span><span class="mf">5.0</span><span class="p">)</span>

<span class="c1"># make one-dimensional plots using the above arrays, add a custom label, linestyles and colors:</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
    <span class="n">a1</span> <span class="o">=</span> <span class="mi">50</span>
    <span class="n">fac</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">wa</span> <span class="o">=</span> <span class="mf">0.10</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">a1</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">a1</span><span class="p">],</span> <span class="n">fac</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">a1</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">a1</span><span class="p">]),</span> <span class="n">fac</span><span class="o">*</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">a1</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">a1</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">wa</span><span class="p">)</span> 


<span class="c1"># change the axis labels to correspond to [0, pi/2, pi, 1.5 * pi, 2*pi, 2.5*pi, 3*pi]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>

<span class="c1"># plot the fixed points: </span>
<span class="n">xfpu</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">yfpu</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xfpu</span><span class="p">,</span> <span class="n">yfpu</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">facecolors</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>

<span class="c1"># plot the fixed points: </span>
<span class="c1">#xfps = [0]</span>
<span class="c1">#yfps = [0]</span>
<span class="c1">#plt.scatter(xfps, yfps, s=80, facecolors=&#39;r&#39;, edgecolors=&#39;r&#39;, zorder=11)</span>

<span class="c1"># the axes:</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="c1">#ax.axvline(x=0, color=&#39;k&#39;)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> <span class="c1"># show the plot here</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/fba5a47a1e2ca864e40f34ad9b51580cddd9f78bbe64d73573d5a99d976ddcb7.png" src="../_images/fba5a47a1e2ca864e40f34ad9b51580cddd9f78bbe64d73573d5a99d976ddcb7.png" />
</div>
</div>
<p>Finally, when <span class="math notranslate nohighlight">\(a&gt;0\)</span>, <span class="math notranslate nohighlight">\(\mathbf{x}^*=\mathbf{0}\)</span> becomes unstable, due to the exponential growth in the <span class="math notranslate nohighlight">\(x\)</span>-direction. Most trajectories veer away from <span class="math notranslate nohighlight">\(\mathbf{x}^*\)</span> and head out to infinity, with the exception of those that start on the <span class="math notranslate nohighlight">\(y\)</span>-axis. Here <span class="math notranslate nohighlight">\(\mathbf{x}^*\)</span> is called a <em>saddle point</em>.</p>
<p>In general, if <span class="math notranslate nohighlight">\(\mathbf{x}^*\)</span> is an attracting fixed point if all trajectories that start near it approach it as <span class="math notranslate nohighlight">\(t \rightarrow \infty\)</span>. If <em>all</em> the trajectories in the phase plane are attracted to it, it is also <em>globally attracting</em></p>
<p>We say that a fixed point <span class="math notranslate nohighlight">\(\mathbf{x}^*\)</span> is <em>Liapunov stable</em> if all trajectories that start sufficintly close to it, remain close to it for all time. E.g., the case of <span class="math notranslate nohighlight">\(a=0\)</span> in the aboce example is Liapunov stable, but not attractive. When a fixed point is Liapunov stable but not attractive, we say that it is <em>neutrally stable</em>. In that case, nearby trajectories are neither attracted nor repelled from a neutrally stable fixed point.</p>
<p>The equilibrium point of a SHO is neutrally stable. Neutral stability is commonly encountered in mechanical systems in the absence of friction.</p>
<p>If a fixed point is Liapunov stable and attracting, we call it <em>stable</em> or <em>asymptotically stable</em>. If the fixed point is unstable, it can be neither attractive nor Liapunov stable.</p>
<p>Let’s study the general case of a two-dimensional linear system i.e. described by a <span class="math notranslate nohighlight">\(2 \times 2\)</span> matrix, with the aim of classifying all the possible phase portraits that can occur.</p>
<p>In the example of the preceding section, the <span class="math notranslate nohighlight">\(x\)</span>- and <span class="math notranslate nohighlight">\(y\)</span>-axes played a crucial geometric role. They determined the direction of the trajectories as <span class="math notranslate nohighlight">\(t\rightarrow \pm \infty\)</span>. They also contained special straight-line trajectories: a trajectory starting on one of the coordinate axes stayed on that axis forever, and exhibited simple exponential growth or decay along it.</p>
<p>For the general case, we would like to find the analog of these straight line trajectories.</p>
<p>That is, we seek trajectories of the form:</p>
<p><span class="math notranslate nohighlight">\(\mathbf{x}(t) = e^{\lambda t} \mathbf{v}\)</span>,</p>
<p>where <span class="math notranslate nohighlight">\(\mathbf{v} \neq \mathbf{0}\)</span> is some <em>fixed</em> vector to be determined, and <span class="math notranslate nohighlight">\(\lambda\)</span> is a growth rate, also to be determined. If such solutions exist, they correspond to exponential motion along the line spanned by the vector <span class="math notranslate nohighlight">\(\mathbf{v}\)</span>.</p>
<p>To find the conditions on <span class="math notranslate nohighlight">\(\mathbf{v}\)</span> and <span class="math notranslate nohighlight">\(\lambda\)</span>, we substitute <span class="math notranslate nohighlight">\(\mathbf{x}(t) = e^{\lambda t} \mathbf{v}\)</span> into <span class="math notranslate nohighlight">\(\mathbf{\dot{x}} = A \mathbf{x}\)</span>, to obtain:</p>
<p><span class="math notranslate nohighlight">\( \lambda e^{\lambda t} \mathbf{v} = \lambda e^{\lambda t} A \mathbf{v}\)</span>,</p>
<p>to obtain:</p>
<p><span class="math notranslate nohighlight">\( \lambda \mathbf{v} = A \mathbf{v}\)</span>,</p>
<p>which tells us that the desired straight line solutions exist if <span class="math notranslate nohighlight">\(\mathbf{v}\)</span> is an <em>eigenvector</em> of <span class="math notranslate nohighlight">\(A\)</span> with corresponding <em>eigenvalue</em> <span class="math notranslate nohighlight">\(\lambda\)</span>.</p>
<p>For the case of <span class="math notranslate nohighlight">\(A = \left(\matrix{a &amp; b\\ c &amp; d}\right)\)</span>, the characteristic equation becomes:</p>
<p><span class="math notranslate nohighlight">\(\mathrm{det}\left(\matrix{a &amp; b\\ c &amp; d}\right) = 0\)</span>,</p>
<p>which yields:</p>
<p><span class="math notranslate nohighlight">\(\lambda^2 + \tau \lambda + \Delta =0\)</span>,</p>
<p>with <span class="math notranslate nohighlight">\(\tau = \mathrm{Tr}(A) = a + d\)</span> and <span class="math notranslate nohighlight">\(\Delta = \mathrm{det}(A) = ad - bc\)</span>.</p>
<p>Then:</p>
<p><span class="math notranslate nohighlight">\(\lambda_{1,2} = \frac{ \tau \pm \sqrt{\tau^2 - 4 \Delta} } { 2}\)</span>,</p>
<p>are the solutions of the quadratic equation.</p>
<p>The typical situation is to have distinct eigenvalues <span class="math notranslate nohighlight">\(\lambda_1 \neq \lambda_2\)</span>, in this case linear algebra tells us that the corresponding eigenvectors <span class="math notranslate nohighlight">\(\mathbf{v_1}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{v_2}\)</span> are <em>linearly independent</em>, and hence they span the entire plane.</p>
<p>For example, any initial condition <span class="math notranslate nohighlight">\(\mathbf{x_0}\)</span> can be written as a linear combination of eigenvectors, say:</p>
<p><span class="math notranslate nohighlight">\(\mathbf{x_0} = c_1 \mathbf{v_1} + c_2 \mathbf{v_2}\)</span>. Then, the <em>general solution</em> for <span class="math notranslate nohighlight">\(\mathbf{x}(t)\)</span> is simply:</p>
<p><span class="math notranslate nohighlight">\(\mathbf{x}(t) = c_1 e^{\lambda_1 t} \mathbf{v_1} + c_2 e^{\lambda_2 t}\mathbf{v_2}\)</span>.</p>
<p>(It satisfies the initial condition and it is a linear combination of solutions, hence it is itself a solution.)</p>
</section>
<section id="example-8-4-solve-the-initial-value-problem-dot-x-x-y-dot-y-4-x-2y-with-initial-condition-x-0-y-0-2-3">
<h2>Example 8.4: Solve the initial value problem <span class="math notranslate nohighlight">\(\dot{x} = x + y\)</span>, <span class="math notranslate nohighlight">\(\dot{y} = 4 x - 2y\)</span> with initial condition <span class="math notranslate nohighlight">\((x_0, y_0) = (2,-3)\)</span>.<a class="headerlink" href="#example-8-4-solve-the-initial-value-problem-dot-x-x-y-dot-y-4-x-2y-with-initial-condition-x-0-y-0-2-3" title="Link to this heading">#</a></h2>
<p>Fortunately, we don’t need to go through the procedure of Example 8.4 to draw the phase portraot of a linear system: all we need to know are the eigenvalues and eigenvectors:</p>
<p>If <span class="math notranslate nohighlight">\(\lambda_1, \lambda_2 &lt; 0\)</span>, there exists a stable fixed point at the origin. If on the other hand <span class="math notranslate nohighlight">\(\lambda_1, \lambda_2 &gt; 0\)</span>, the node is unstable. If one of the eigenvalues is positive and the other negative, the node is a saddle point.</p>
<p>What if the eigenvalues are complex? Then the solution is a <em>center</em> or a (stable or unstable) <em>spiral</em>.</p>
<p>if the eigenvalues are equal, then we have a <em>star node</em>.</p>
<p>(And if there’s only one eigenvalue, the fixed point is a <em>degenerate node</em>).</p>
</section>
<section id="the-phase-plane-and-phase-portraits">
<h2>The Phase Plane and Phase Portraits<a class="headerlink" href="#the-phase-plane-and-phase-portraits" title="Link to this heading">#</a></h2>
<p>Our goal here of course is to study nonlinear systems. In 2D, the general form of a vector field on the phase plane is given by:</p>
<p><span class="math notranslate nohighlight">\(\dot{x}_1 = f_1(x_1, x_2)\)</span>,</p>
<p><span class="math notranslate nohighlight">\(\dot{x}_2 = f_2(x_1, x_2)\)</span>,</p>
<p>where <span class="math notranslate nohighlight">\(f_{1,2}\)</span> are given functions.</p>
<p>We may also write the system more compactly in vector notation as:</p>
<p><span class="math notranslate nohighlight">\(\mathbf{\dot{x}} = \mathbf{f}(\mathbf{x})\)</span>, where <span class="math notranslate nohighlight">\(\mathbf{x} = (x_1, x_2)\)</span> and <span class="math notranslate nohighlight">\(\mathbf{f}(\mathbf{x}) = (f_1(\mathbf{x}), f_2(\mathbf{x}))\)</span>.</p>
<p>Here, <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> represents a point on the phase plane and <span class="math notranslate nohighlight">\(\mathbf{\dot{x}}\)</span> is the velocity vector at that point. By flowing along the vector field, a phase point traces out a solution <span class="math notranslate nohighlight">\(\mathbf{x}(t)\)</span>, corresponding to a trajectory winding through the phase plane.</p>
<p>Furthermore, the entire phase plane is filled with trajectories, since each point can play the role of an initial conditions.</p>
<p>For nonlinear systems, there’s typically no hope of finding the trajectories analytically. Even when explicit formulas are available, they are often too complicated to provide much insight. Instead, we wish to determine first the qualitative behavior of the solutions by analytical considerations, and to probe the quantitative aspects numerically.</p>
</section>
<section id="fixed-points-and-linearization">
<h2>Fixed Points and Linearization<a class="headerlink" href="#fixed-points-and-linearization" title="Link to this heading">#</a></h2>
<p>To examine the nature of fixed points of nonlinear systems, we can apply the <em>linearization</em> technique in two dimensions.</p>
<p>Consider the system:</p>
<p><span class="math notranslate nohighlight">\(\dot{x} = f(x,y)\)</span>,</p>
<p><span class="math notranslate nohighlight">\(\dot{y} = g(x,y)\)</span>,</p>
<p>and suppose that <span class="math notranslate nohighlight">\((x^*, y^*)\)</span> is a fixed point, i.e.:</p>
<p><span class="math notranslate nohighlight">\(f(x^*, y^*) = 0\)</span> and <span class="math notranslate nohighlight">\(g(x^*, y^*) = 0\)</span>.</p>
<p>Let <span class="math notranslate nohighlight">\(u = x - x^*\)</span> and <span class="math notranslate nohighlight">\(v = y-y^*\)</span> be small disturbances from the fixed point.</p>
<p>To see whether the disturbance grows or decays, we need to derive differential equations for <span class="math notranslate nohighlight">\(u\)</span> and <span class="math notranslate nohighlight">\(v\)</span>:</p>
<p><span class="math notranslate nohighlight">\(\dot{u} = \dot{x} = f(x^* + u, y^* + v)\)</span>.</p>
<p>Taylor-expand the function on the right-hand side about <span class="math notranslate nohighlight">\((x^*, y^*)\)</span> to get:</p>
<p><span class="math notranslate nohighlight">\(\dot{u} = f(x^*, y^*) + u \frac{\partial f}{\partial x} + v \frac{\partial f}{\partial y}  + \mathcal{O}(u^2, v^2, uv)\)</span>.</p>
<p>Since <span class="math notranslate nohighlight">\(f(x^*, y^*) = 0\)</span>, we end up with:</p>
<p><span class="math notranslate nohighlight">\(\dot{u} = u \left.\frac{\partial f}{\partial x}\right|_* + v \left.\frac{\partial f}{\partial y}\right|_*  + \mathcal{O}(u^2, v^2, uv)\)</span>.</p>
<p>Similarly, for <span class="math notranslate nohighlight">\(v\)</span>, we get:</p>
<p><span class="math notranslate nohighlight">\(\dot{v} = u \left.\frac{\partial g}{\partial x}\right|_*  + v \left.\frac{\partial g}{\partial y}\right|_*   + \mathcal{O}(u^2, v^2, uv)\)</span>,</p>
<p>where the <span class="math notranslate nohighlight">\(*\)</span> denotes that the derivatives are evaluated at the fixed point.</p>
<p>Hence, the disturbance <span class="math notranslate nohighlight">\((u,v)\)</span>, evolves according to:</p>
<p><span class="math notranslate nohighlight">\(\left(\matrix{\dot{u}\\\dot{v}}\right) = \left(\matrix{\frac{\partial f}{\partial x} &amp; \frac{\partial f}{\partial y}\\ \frac{\partial g}{\partial x} &amp; \frac{\partial g}{\partial y}}\right)_{(x^*, y^*)} \left(\matrix{u\\v}\right) + \mathrm{quadratic~terms}\)</span>.</p>
<p>You may recognize: <span class="math notranslate nohighlight">\(J = \left(\matrix{\frac{\partial f}{\partial x} &amp; \frac{\partial f}{\partial y}\\ \frac{\partial g}{\partial x} &amp; \frac{\partial g}{\partial y}}\right)_{(x^*, y^*)} \)</span> as the Jacobian matrix!</p>
<p>Now, since the quadratic terms are tiny, it is tempting to neglect them altogether and obtain a linearized system:</p>
<p><span class="math notranslate nohighlight">\(\left(\matrix{\dot{u}\\\dot{v}}\right)=\left(\matrix{\frac{\partial f}{\partial x} &amp; \frac{\partial f}{\partial y}\\ \frac{\partial g}{\partial x} &amp; \frac{\partial g}{\partial y}}\right)_{(x^*, y^*)} \left(\matrix{u\\v}\right)\)</span>,</p>
<p>which we know how to analyze!</p>
<p>Is it really safe to neglect the quadratic terms? The answer is yes, as long as the fixed point for the linearized system is not a borderline case (center, degenerate node, star or non-isolated fixed point).</p>
<p>If the linearized system predicts a saddle, node, or a spiral, then the fixed point <em>really</em> is a saddle, node or spiral for the original nonlinear system.</p>
</section>
<section id="example-8-5-consider-the-system-dot-x-x-e-y-and-dot-y-y-first-use-qualitative-arguments-to-obtain-information-about-the-phase-portrait-then-use-the-runge-kutta-method-to-compute-several-trajectories-and-plot-them-on-the-phase-plane">
<h2>Example 8.5: Consider the system <span class="math notranslate nohighlight">\(\dot{x} = x + e^{-y}\)</span> and <span class="math notranslate nohighlight">\(\dot{y} = -y\)</span>. First use qualitative arguments to obtain information about the phase portrait. Then, use the Runge-Kutta method to compute several trajectories, and plot them on the phase plane.<a class="headerlink" href="#example-8-5-consider-the-system-dot-x-x-e-y-and-dot-y-y-first-use-qualitative-arguments-to-obtain-information-about-the-phase-portrait-then-use-the-runge-kutta-method-to-compute-several-trajectories-and-plot-them-on-the-phase-plane" title="Link to this heading">#</a></h2>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="the-lorenz-equations-and-chaos">
<h1>The Lorenz Equations and Chaos<a class="headerlink" href="#the-lorenz-equations-and-chaos" title="Link to this heading">#</a></h1>
<p>We begin our brief introduction to the concept of chaos with the Lorenz equations:</p>
<p><span class="math notranslate nohighlight">\(\dot{x} = \sigma( y - x)\)</span>,</p>
<p><span class="math notranslate nohighlight">\(\dot{y} = rx - y - xz\)</span>,</p>
<p><span class="math notranslate nohighlight">\(\dot{z} = xy - bz\)</span>,</p>
<p>where <span class="math notranslate nohighlight">\(\sigma, r, b &gt; 0\)</span> are parameters.</p>
<p>Ed Lorenz (1963) derived this three-dimensional system from a drastically simplified model of convection rolls in the atmosphere.</p>
<p><img alt="Convection Rolls (wikipedia)" src="https://upload.wikimedia.org/wikipedia/commons/f/fd/Convrolls.PNG" /></p>
<p>The same equations also arise in models of lasers and dynamos, and they describe exactly the motion of a certain whaterwheel.</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/File:Malkus_Waterwheel_side_by_side.webm">https://en.wikipedia.org/wiki/File:Malkus_Waterwheel_side_by_side.webm</a></p>
<p>Lorenz discovered that this simple-looking, deterministic system could have extremely erratic dynamics. In particular, over a wide range of parameters, the solutions oscillate irregularly, never exactly repeating, but always remaining in a bounded region of phase space.</p>
<p>When he plotted the trajectories in 3D, he discovered that they settled onto a complicated set, now known as a <em>strange attractor</em>, a fractal with dimension between 2 and 3.</p>
<section id="simple-properties-of-the-lorenz-equations">
<h2>Simple Properties of the Lorenz Equations<a class="headerlink" href="#simple-properties-of-the-lorenz-equations" title="Link to this heading">#</a></h2>
<p><span class="math notranslate nohighlight">\(\dot{x} = \sigma( y - x)\)</span>,</p>
<p><span class="math notranslate nohighlight">\(\dot{y} = rx - y - xz\)</span>,</p>
<p><span class="math notranslate nohighlight">\(\dot{z} = xy - bz\)</span>.</p>
<p>Τhe <span class="math notranslate nohighlight">\(\sigma\)</span> parameter is also known as the Prandtl number, <span class="math notranslate nohighlight">\(r\)</span> is known as the Rayleigh number and <span class="math notranslate nohighlight">\(b\)</span> has no name (in the convection problem it is related to the aspect ratio of he convection rolls).</p>
<p>The system has two nonlinearities: <span class="math notranslate nohighlight">\(xy\)</span> and <span class="math notranslate nohighlight">\(xz\)</span>. There’s also a symmetry: <span class="math notranslate nohighlight">\((x,y) \rightarrow (-x, -y)\)</span> which leaves the equations unchanged.</p>
<p>The point <span class="math notranslate nohighlight">\((x^*, y^*, z^*) = (0,0,0)\)</span> is a fixed point for all values of the parameters. For <span class="math notranslate nohighlight">\(r&gt;1\)</span>, there’s also a symmetric pair of fixed points at:</p>
<p><span class="math notranslate nohighlight">\(x^* = y^* = \pm \sqrt{b(r-1)}\)</span>, <span class="math notranslate nohighlight">\(z^* = r-1\)</span>, called <span class="math notranslate nohighlight">\(C^+\)</span> and <span class="math notranslate nohighlight">\(C^-\)</span>, respectively. As <span class="math notranslate nohighlight">\(r \rightarrow 1^+\)</span>, <span class="math notranslate nohighlight">\(C^+\)</span> and <span class="math notranslate nohighlight">\(C^-\)</span> coalesce with the origin.</p>
<section id="linear-stability-of-the-origin">
<h3>Linear Stability of the Origin<a class="headerlink" href="#linear-stability-of-the-origin" title="Link to this heading">#</a></h3>
<p>Linearizing the Lorenz equations at the origin, we get:</p>
<p><span class="math notranslate nohighlight">\(\dot{x} = \sigma(y-x)\)</span>,</p>
<p><span class="math notranslate nohighlight">\(\dot{y} = rx -y\)</span>,</p>
<p><span class="math notranslate nohighlight">\(\dot{z} = -bz\)</span>.</p>
<p>The equation for <span class="math notranslate nohighlight">\(z\)</span> is decoupled and shows that <span class="math notranslate nohighlight">\(z(t) \rightarrow 0\)</span> exponentially fast. The other two directions are governed by the system:</p>
<p><span class="math notranslate nohighlight">\(\left(\matrix{\dot{x}\\\dot{y}}\right) =\left(\matrix{-\sigma &amp; \sigma\\ r &amp; -1}\right) \left(\matrix{x\\ y}\right)\)</span>,</p>
<p>with trace <span class="math notranslate nohighlight">\(\tau = -\sigma -1 &lt; 0\)</span> and determinant <span class="math notranslate nohighlight">\(\Delta = \sigma(1 -r)\)</span>.</p>
<p>if <span class="math notranslate nohighlight">\(r&gt;1\)</span> the origin is a saddle point because <span class="math notranslate nohighlight">\(\Delta &lt; 0\)</span>. Note that this is a new type of saddle point, since the full system is 3D. If <span class="math notranslate nohighlight">\(r&lt;1\)</span> all the directions are incoming and the origin is a sink and a stable node.</p>
<p>Moreover, it can be shown that for <span class="math notranslate nohighlight">\(r&lt;1\)</span> that every trajectory approaches the origin as <span class="math notranslate nohighlight">\(t \rightarrow \infty\)</span>, and therefore the origin is <em>globally</em> stable.</p>
<p>For a range of <span class="math notranslate nohighlight">\(r\)</span>: <span class="math notranslate nohighlight">\(1 &lt; r &lt; r_H =\frac{ \sigma (\sigma + b + 3) }{\sigma - b -1}\)</span>, trajectories have a bizarre kind of long-term behavior. Like balls in a pinball machine, they are repelled from one unstable object after another. At the same time, they are confined to a bounded set of zero volume, yet they manage to move on this set forever, without intersecting themselves or others.</p>
</section>
</section>
<section id="exercise-8-1-chaos-on-a-strange-attractor">
<h2>Exercise 8.1: Chaos on a Strange Attractor<a class="headerlink" href="#exercise-8-1-chaos-on-a-strange-attractor" title="Link to this heading">#</a></h2>
<p>(See file Exercise8.1.ipynb)</p>
</section>
<section id="the-definition-of-chaos">
<h2>The Definition of Chaos<a class="headerlink" href="#the-definition-of-chaos" title="Link to this heading">#</a></h2>
<p>No definition of “chaos” is universally accepted, but almost everyone would agree on three ingredients used in the following working definition:</p>
<p>“Chaos is aperiodic long-term behavior in a deterministic system that exhibits sensitive dependence on initial conditions.”</p>
<ol class="arabic simple">
<li><p>“Aperiodic long-term behavior” implies that the trajectories do not settle down to fixed points, periodic orbits, or quasiperiodic orbits as <span class="math notranslate nohighlight">\(t\rightarrow \infty\)</span>. For practical reasons, we require that such trajectories are not too rare.</p></li>
<li><p>“Deterministic” means that the system has no random or noisy inputs or parameters. The irregular behavior of the system arises from the system’s nonlinearity, rather than from noisy driving forces.</p></li>
<li><p>“Sensitive dependence on initial conditions” means that nearby trajectories separate exponentially fast, i.e. the system has positive Liapunov exponent.</p></li>
</ol>
</section>
<section id="lorenz-attractor-animation">
<h2>Lorenz Attractor Animation<a class="headerlink" href="#lorenz-attractor-animation" title="Link to this heading">#</a></h2>
<p>We end this chapter with an animation of the Lorenz Attractor, demonstrating the exponential deviation of two trajectories with similar initial conditions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">scipy</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">IPython</span> <span class="kn">import</span> <span class="n">display</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># the name of the function is: </span>
<span class="c1"># scipy.integrate.solve_ivp, which by default uses the Runge-Kutta &quot;45&quot; method,</span>
<span class="c1"># a modified version of the Runge-Kutta 4-th order algo that has a variable step size. </span>

<span class="c1"># fix the parameters to have the values that Lorenz used: </span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">r</span> <span class="o">=</span> <span class="mi">28</span>
<span class="n">b</span> <span class="o">=</span> <span class="mi">8</span><span class="o">/</span><span class="mi">3</span>

<span class="c1"># first define the function vector</span>
<span class="c1"># y is a 3D vector here! t is necessary as well, but our function does not depend on time here</span>
<span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span> 
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the function vector&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">sigma</span> <span class="o">*</span> <span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> 
            <span class="n">r</span> <span class="o">*</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
            <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">b</span> <span class="o">*</span> <span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>

<span class="c1"># Now get the solution:</span>
<span class="n">y0</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">solarray</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">tmax</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">t_eval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tmax</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">t_range</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tmax</span><span class="p">)</span>
<span class="n">sol</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">integrate</span><span class="o">.</span><span class="n">solve_ivp</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">t_range</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">t_eval</span><span class="o">=</span><span class="n">t_eval</span><span class="p">)</span>
<span class="n">y0</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="o">+</span><span class="mf">1E-2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">sol2</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">integrate</span><span class="o">.</span><span class="n">solve_ivp</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">t_range</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">t_eval</span><span class="o">=</span><span class="n">t_eval</span><span class="p">)</span>

<span class="c1"># PLOT:</span>

<span class="n">dynamicdisplay</span> <span class="o">=</span> <span class="n">display</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">display_id</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;projection&quot;</span><span class="p">:</span> <span class="s2">&quot;3d&quot;</span><span class="p">})</span> <span class="c1"># create the elements required for matplotlib. This creates a figure containing a single axes.</span>

<span class="c1"># set the labels and titles:</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$x(t)$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> <span class="c1"># set the x label</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$y(t)$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> <span class="c1"># set the y label</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$z(t)$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> <span class="c1"># set the y label</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;The Lorenz Attractor&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span> <span class="c1"># set the title </span>

<span class="c1"># set the x and y limits:</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_zlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span>


<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ti</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sol</span><span class="o">.</span><span class="n">t</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">][:</span><span class="n">i</span><span class="p">],</span> <span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">][:</span><span class="n">i</span><span class="p">],</span> <span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">][:</span><span class="n">i</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sol2</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">][:</span><span class="n">i</span><span class="p">],</span> <span class="n">sol2</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">][:</span><span class="n">i</span><span class="p">],</span> <span class="n">sol2</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">][:</span><span class="n">i</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">dynamicdisplay</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ffc71461c1c41dcd9babaf04c1ed891d1895e5e4047e4f945dd9c8ad5e6288fb.png" src="../_images/ffc71461c1c41dcd9babaf04c1ed891d1895e5e4047e4f945dd9c8ad5e6288fb.png" />
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyboardInterrupt</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">9</span><span class="p">],</span> <span class="n">line</span> <span class="mi">55</span>
<span class="g g-Whitespace">     </span><span class="mi">53</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">][:</span><span class="n">i</span><span class="p">],</span> <span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">][:</span><span class="n">i</span><span class="p">],</span> <span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">][:</span><span class="n">i</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">54</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sol2</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">][:</span><span class="n">i</span><span class="p">],</span> <span class="n">sol2</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">][:</span><span class="n">i</span><span class="p">],</span> <span class="n">sol2</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">][:</span><span class="n">i</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">55</span> <span class="n">dynamicdisplay</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>

<span class="nn">File /opt/homebrew/lib/python3.10/site-packages/IPython/core/display_functions.py:374,</span> in <span class="ni">DisplayHandle.update</span><span class="nt">(self, obj, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">364</span> <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">365</span><span class="w">     </span><span class="sd">&quot;&quot;&quot;Update existing displays with my id</span>
<span class="g g-Whitespace">    </span><span class="mi">366</span><span class="sd"> </span>
<span class="g g-Whitespace">    </span><span class="mi">367</span><span class="sd">     Parameters</span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">    </span><span class="mi">372</span><span class="sd">         additional keyword arguments passed to update_display</span>
<span class="g g-Whitespace">    </span><span class="mi">373</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">374</span>     <span class="n">update_display</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">display_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">display_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">File /opt/homebrew/lib/python3.10/site-packages/IPython/core/display_functions.py:326,</span> in <span class="ni">update_display</span><span class="nt">(obj, display_id, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">312</span><span class="w"> </span><span class="sd">&quot;&quot;&quot;Update an existing display by id</span>
<span class="g g-Whitespace">    </span><span class="mi">313</span><span class="sd"> </span>
<span class="g g-Whitespace">    </span><span class="mi">314</span><span class="sd"> Parameters</span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">    </span><span class="mi">323</span><span class="sd"> :func:`display`</span>
<span class="g g-Whitespace">    </span><span class="mi">324</span><span class="sd"> &quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">325</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;update&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<span class="ne">--&gt; </span><span class="mi">326</span> <span class="n">display</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">display_id</span><span class="o">=</span><span class="n">display_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">File /opt/homebrew/lib/python3.10/site-packages/IPython/core/display_functions.py:298,</span> in <span class="ni">display</span><span class="nt">(include, exclude, metadata, transient, display_id, raw, clear, *objs, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">296</span>     <span class="n">publish_display_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">297</span> <span class="k">else</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">298</span>     <span class="n">format_dict</span><span class="p">,</span> <span class="n">md_dict</span> <span class="o">=</span> <span class="nb">format</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">include</span><span class="o">=</span><span class="n">include</span><span class="p">,</span> <span class="n">exclude</span><span class="o">=</span><span class="n">exclude</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">299</span>     <span class="k">if</span> <span class="ow">not</span> <span class="n">format_dict</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">300</span>         <span class="c1"># nothing to display (e.g. _ipython_display_ took over)</span>
<span class="g g-Whitespace">    </span><span class="mi">301</span>         <span class="k">continue</span>

<span class="nn">File /opt/homebrew/lib/python3.10/site-packages/IPython/core/formatters.py:182,</span> in <span class="ni">DisplayFormatter.format</span><span class="nt">(self, obj, include, exclude)</span>
<span class="g g-Whitespace">    </span><span class="mi">180</span> <span class="n">md</span> <span class="o">=</span> <span class="kc">None</span>
<span class="g g-Whitespace">    </span><span class="mi">181</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">182</span>     <span class="n">data</span> <span class="o">=</span> <span class="n">formatter</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">183</span> <span class="k">except</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">184</span>     <span class="c1"># FIXME: log the exception</span>
<span class="g g-Whitespace">    </span><span class="mi">185</span>     <span class="k">raise</span>

<span class="nn">File /opt/homebrew/lib/python3.10/site-packages/decorator.py:232,</span> in <span class="ni">decorate.&lt;locals&gt;.fun</span><span class="nt">(*args, **kw)</span>
<span class="g g-Whitespace">    </span><span class="mi">230</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">kwsyntax</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">231</span>     <span class="n">args</span><span class="p">,</span> <span class="n">kw</span> <span class="o">=</span> <span class="n">fix</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">kw</span><span class="p">,</span> <span class="n">sig</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">232</span> <span class="k">return</span> <span class="n">caller</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="o">*</span><span class="p">(</span><span class="n">extras</span> <span class="o">+</span> <span class="n">args</span><span class="p">),</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>

<span class="nn">File /opt/homebrew/lib/python3.10/site-packages/IPython/core/formatters.py:226,</span> in <span class="ni">catch_format_error</span><span class="nt">(method, self, *args, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">224</span><span class="w"> </span><span class="sd">&quot;&quot;&quot;show traceback on failed format call&quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">225</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">226</span>     <span class="n">r</span> <span class="o">=</span> <span class="n">method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">227</span> <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">228</span>     <span class="c1"># don&#39;t warn on NotImplementedErrors</span>
<span class="g g-Whitespace">    </span><span class="mi">229</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_return</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="nn">File /opt/homebrew/lib/python3.10/site-packages/IPython/core/formatters.py:343,</span> in <span class="ni">BaseFormatter.__call__</span><span class="nt">(self, obj)</span>
<span class="g g-Whitespace">    </span><span class="mi">341</span>     <span class="k">pass</span>
<span class="g g-Whitespace">    </span><span class="mi">342</span> <span class="k">else</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">343</span>     <span class="k">return</span> <span class="n">printer</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">344</span> <span class="c1"># Finally look for special method names</span>
<span class="g g-Whitespace">    </span><span class="mi">345</span> <span class="n">method</span> <span class="o">=</span> <span class="n">get_real_method</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_method</span><span class="p">)</span>

<span class="nn">File /opt/homebrew/lib/python3.10/site-packages/IPython/core/pylabtools.py:152,</span> in <span class="ni">print_figure</span><span class="nt">(fig, fmt, bbox_inches, base64, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">149</span>     <span class="kn">from</span> <span class="nn">matplotlib.backend_bases</span> <span class="kn">import</span> <span class="n">FigureCanvasBase</span>
<span class="g g-Whitespace">    </span><span class="mi">150</span>     <span class="n">FigureCanvasBase</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">152</span> <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">print_figure</span><span class="p">(</span><span class="n">bytes_io</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">153</span> <span class="n">data</span> <span class="o">=</span> <span class="n">bytes_io</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">154</span> <span class="k">if</span> <span class="n">fmt</span> <span class="o">==</span> <span class="s1">&#39;svg&#39;</span><span class="p">:</span>

<span class="nn">File /opt/homebrew/lib/python3.10/site-packages/matplotlib/backend_bases.py:2187,</span> in <span class="ni">FigureCanvasBase.print_figure</span><span class="nt">(self, filename, dpi, facecolor, edgecolor, orientation, format, bbox_inches, pad_inches, bbox_extra_artists, backend, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">2183</span> <span class="k">try</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">2184</span>     <span class="c1"># _get_renderer may change the figure dpi (as vector formats</span>
<span class="g g-Whitespace">   </span><span class="mi">2185</span>     <span class="c1"># force the figure dpi to 72), so we need to set it again here.</span>
<span class="g g-Whitespace">   </span><span class="mi">2186</span>     <span class="k">with</span> <span class="n">cbook</span><span class="o">.</span><span class="n">_setattr_cm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">):</span>
<span class="ne">-&gt; </span><span class="mi">2187</span>         <span class="n">result</span> <span class="o">=</span> <span class="n">print_method</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">2188</span>             <span class="n">filename</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2189</span>             <span class="n">facecolor</span><span class="o">=</span><span class="n">facecolor</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2190</span>             <span class="n">edgecolor</span><span class="o">=</span><span class="n">edgecolor</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2191</span>             <span class="n">orientation</span><span class="o">=</span><span class="n">orientation</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2192</span>             <span class="n">bbox_inches_restore</span><span class="o">=</span><span class="n">_bbox_inches_restore</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2193</span>             <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2194</span> <span class="k">finally</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">2195</span>     <span class="k">if</span> <span class="n">bbox_inches</span> <span class="ow">and</span> <span class="n">restore_bbox</span><span class="p">:</span>

<span class="nn">File /opt/homebrew/lib/python3.10/site-packages/matplotlib/backend_bases.py:2043,</span> in <span class="ni">FigureCanvasBase._switch_canvas_and_return_print_method.&lt;locals&gt;.&lt;lambda&gt;</span><span class="nt">(*args, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">2039</span>     <span class="n">optional_kws</span> <span class="o">=</span> <span class="p">{</span>  <span class="c1"># Passed by print_figure for other renderers.</span>
<span class="g g-Whitespace">   </span><span class="mi">2040</span>         <span class="s2">&quot;dpi&quot;</span><span class="p">,</span> <span class="s2">&quot;facecolor&quot;</span><span class="p">,</span> <span class="s2">&quot;edgecolor&quot;</span><span class="p">,</span> <span class="s2">&quot;orientation&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2041</span>         <span class="s2">&quot;bbox_inches_restore&quot;</span><span class="p">}</span>
<span class="g g-Whitespace">   </span><span class="mi">2042</span>     <span class="n">skip</span> <span class="o">=</span> <span class="n">optional_kws</span> <span class="o">-</span> <span class="p">{</span><span class="o">*</span><span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="n">meth</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span><span class="p">}</span>
<span class="ne">-&gt; </span><span class="mi">2043</span>     <span class="n">print_method</span> <span class="o">=</span> <span class="n">functools</span><span class="o">.</span><span class="n">wraps</span><span class="p">(</span><span class="n">meth</span><span class="p">)(</span><span class="k">lambda</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">meth</span><span class="p">(</span>
<span class="nn">   2044         *args, **{k: v for k, v</span> in <span class="ni">kwargs.items</span><span class="nt">() if k not in skip}))</span>
<span class="g g-Whitespace">   </span><span class="mi">2045</span> <span class="k">else</span><span class="p">:</span>  <span class="c1"># Let third-parties do as they see fit.</span>
<span class="g g-Whitespace">   </span><span class="mi">2046</span>     <span class="n">print_method</span> <span class="o">=</span> <span class="n">meth</span>

<span class="nn">File /opt/homebrew/lib/python3.10/site-packages/matplotlib/backends/backend_agg.py:497,</span> in <span class="ni">FigureCanvasAgg.print_png</span><span class="nt">(self, filename_or_obj, metadata, pil_kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">450</span> <span class="k">def</span> <span class="nf">print_png</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename_or_obj</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pil_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">451</span><span class="w">     </span><span class="sd">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">452</span><span class="sd">     Write the figure to a PNG file.</span>
<span class="g g-Whitespace">    </span><span class="mi">453</span><span class="sd"> </span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">    </span><span class="mi">495</span><span class="sd">         *metadata*, including the default &#39;Software&#39; key.</span>
<span class="g g-Whitespace">    </span><span class="mi">496</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">497</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_print_pil</span><span class="p">(</span><span class="n">filename_or_obj</span><span class="p">,</span> <span class="s2">&quot;png&quot;</span><span class="p">,</span> <span class="n">pil_kwargs</span><span class="p">,</span> <span class="n">metadata</span><span class="p">)</span>

<span class="nn">File /opt/homebrew/lib/python3.10/site-packages/matplotlib/backends/backend_agg.py:445,</span> in <span class="ni">FigureCanvasAgg._print_pil</span><span class="nt">(self, filename_or_obj, fmt, pil_kwargs, metadata)</span>
<span class="g g-Whitespace">    </span><span class="mi">440</span> <span class="k">def</span> <span class="nf">_print_pil</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename_or_obj</span><span class="p">,</span> <span class="n">fmt</span><span class="p">,</span> <span class="n">pil_kwargs</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">441</span><span class="w">     </span><span class="sd">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">442</span><span class="sd">     Draw the canvas, then save it using `.image.imsave` (to which</span>
<span class="g g-Whitespace">    </span><span class="mi">443</span><span class="sd">     *pil_kwargs* and *metadata* are forwarded).</span>
<span class="g g-Whitespace">    </span><span class="mi">444</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">445</span>     <span class="n">FigureCanvasAgg</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">446</span>     <span class="n">mpl</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">imsave</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">447</span>         <span class="n">filename_or_obj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">buffer_rgba</span><span class="p">(),</span> <span class="nb">format</span><span class="o">=</span><span class="n">fmt</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s2">&quot;upper&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">448</span>         <span class="n">dpi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">dpi</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span> <span class="n">pil_kwargs</span><span class="o">=</span><span class="n">pil_kwargs</span><span class="p">)</span>

<span class="nn">File /opt/homebrew/lib/python3.10/site-packages/matplotlib/backends/backend_agg.py:388,</span> in <span class="ni">FigureCanvasAgg.draw</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">385</span> <span class="c1"># Acquire a lock on the shared font cache.</span>
<span class="g g-Whitespace">    </span><span class="mi">386</span> <span class="k">with</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toolbar</span><span class="o">.</span><span class="n">_wait_cursor_for_draw_cm</span><span class="p">()</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">toolbar</span>
<span class="g g-Whitespace">    </span><span class="mi">387</span>       <span class="k">else</span> <span class="n">nullcontext</span><span class="p">()):</span>
<span class="ne">--&gt; </span><span class="mi">388</span>     <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">renderer</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">389</span>     <span class="c1"># A GUI class may be need to update a window using this draw, so</span>
<span class="g g-Whitespace">    </span><span class="mi">390</span>     <span class="c1"># don&#39;t forget to call the superclass.</span>
<span class="g g-Whitespace">    </span><span class="mi">391</span>     <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

<span class="nn">File /opt/homebrew/lib/python3.10/site-packages/matplotlib/artist.py:95,</span> in <span class="ni">_finalize_rasterization.&lt;locals&gt;.draw_wrapper</span><span class="nt">(artist, renderer, *args, **kwargs)</span>
<span class="g g-Whitespace">     </span><span class="mi">93</span> <span class="nd">@wraps</span><span class="p">(</span><span class="n">draw</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">94</span> <span class="k">def</span> <span class="nf">draw_wrapper</span><span class="p">(</span><span class="n">artist</span><span class="p">,</span> <span class="n">renderer</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="ne">---&gt; </span><span class="mi">95</span>     <span class="n">result</span> <span class="o">=</span> <span class="n">draw</span><span class="p">(</span><span class="n">artist</span><span class="p">,</span> <span class="n">renderer</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">96</span>     <span class="k">if</span> <span class="n">renderer</span><span class="o">.</span><span class="n">_rasterizing</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">97</span>         <span class="n">renderer</span><span class="o">.</span><span class="n">stop_rasterizing</span><span class="p">()</span>

<span class="nn">File /opt/homebrew/lib/python3.10/site-packages/matplotlib/artist.py:72,</span> in <span class="ni">allow_rasterization.&lt;locals&gt;.draw_wrapper</span><span class="nt">(artist, renderer)</span>
<span class="g g-Whitespace">     </span><span class="mi">69</span>     <span class="k">if</span> <span class="n">artist</span><span class="o">.</span><span class="n">get_agg_filter</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">70</span>         <span class="n">renderer</span><span class="o">.</span><span class="n">start_filter</span><span class="p">()</span>
<span class="ne">---&gt; </span><span class="mi">72</span>     <span class="k">return</span> <span class="n">draw</span><span class="p">(</span><span class="n">artist</span><span class="p">,</span> <span class="n">renderer</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">73</span> <span class="k">finally</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">74</span>     <span class="k">if</span> <span class="n">artist</span><span class="o">.</span><span class="n">get_agg_filter</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

<span class="nn">File /opt/homebrew/lib/python3.10/site-packages/matplotlib/figure.py:3154,</span> in <span class="ni">Figure.draw</span><span class="nt">(self, renderer)</span>
<span class="g g-Whitespace">   </span><span class="mi">3151</span>         <span class="c1"># ValueError can occur when resizing a window.</span>
<span class="g g-Whitespace">   </span><span class="mi">3153</span> <span class="bp">self</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">3154</span> <span class="n">mimage</span><span class="o">.</span><span class="n">_draw_list_compositing_images</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">3155</span>     <span class="n">renderer</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">artists</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">suppressComposite</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3157</span> <span class="k">for</span> <span class="n">sfig</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">subfigs</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">3158</span>     <span class="n">sfig</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>

<span class="nn">File /opt/homebrew/lib/python3.10/site-packages/matplotlib/image.py:132,</span> in <span class="ni">_draw_list_compositing_images</span><span class="nt">(renderer, parent, artists, suppress_composite)</span>
<span class="g g-Whitespace">    </span><span class="mi">130</span> <span class="k">if</span> <span class="n">not_composite</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">has_images</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">131</span>     <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">artists</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">132</span>         <span class="n">a</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">133</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">134</span>     <span class="c1"># Composite any adjacent images together</span>
<span class="g g-Whitespace">    </span><span class="mi">135</span>     <span class="n">image_group</span> <span class="o">=</span> <span class="p">[]</span>

<span class="nn">File /opt/homebrew/lib/python3.10/site-packages/matplotlib/artist.py:72,</span> in <span class="ni">allow_rasterization.&lt;locals&gt;.draw_wrapper</span><span class="nt">(artist, renderer)</span>
<span class="g g-Whitespace">     </span><span class="mi">69</span>     <span class="k">if</span> <span class="n">artist</span><span class="o">.</span><span class="n">get_agg_filter</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">70</span>         <span class="n">renderer</span><span class="o">.</span><span class="n">start_filter</span><span class="p">()</span>
<span class="ne">---&gt; </span><span class="mi">72</span>     <span class="k">return</span> <span class="n">draw</span><span class="p">(</span><span class="n">artist</span><span class="p">,</span> <span class="n">renderer</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">73</span> <span class="k">finally</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">74</span>     <span class="k">if</span> <span class="n">artist</span><span class="o">.</span><span class="n">get_agg_filter</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

<span class="nn">File /opt/homebrew/lib/python3.10/site-packages/mpl_toolkits/mplot3d/axes3d.py:497,</span> in <span class="ni">Axes3D.draw</span><span class="nt">(self, renderer)</span>
<span class="g g-Whitespace">    </span><span class="mi">494</span>         <span class="n">axis</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">496</span> <span class="c1"># Then rest</span>
<span class="ne">--&gt; </span><span class="mi">497</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>

<span class="nn">File /opt/homebrew/lib/python3.10/site-packages/matplotlib/artist.py:72,</span> in <span class="ni">allow_rasterization.&lt;locals&gt;.draw_wrapper</span><span class="nt">(artist, renderer)</span>
<span class="g g-Whitespace">     </span><span class="mi">69</span>     <span class="k">if</span> <span class="n">artist</span><span class="o">.</span><span class="n">get_agg_filter</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">70</span>         <span class="n">renderer</span><span class="o">.</span><span class="n">start_filter</span><span class="p">()</span>
<span class="ne">---&gt; </span><span class="mi">72</span>     <span class="k">return</span> <span class="n">draw</span><span class="p">(</span><span class="n">artist</span><span class="p">,</span> <span class="n">renderer</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">73</span> <span class="k">finally</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">74</span>     <span class="k">if</span> <span class="n">artist</span><span class="o">.</span><span class="n">get_agg_filter</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

<span class="nn">File /opt/homebrew/lib/python3.10/site-packages/matplotlib/axes/_base.py:3070,</span> in <span class="ni">_AxesBase.draw</span><span class="nt">(self, renderer)</span>
<span class="g g-Whitespace">   </span><span class="mi">3067</span> <span class="k">if</span> <span class="n">artists_rasterized</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">3068</span>     <span class="n">_draw_rasterized</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="p">,</span> <span class="n">artists_rasterized</span><span class="p">,</span> <span class="n">renderer</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">3070</span> <span class="n">mimage</span><span class="o">.</span><span class="n">_draw_list_compositing_images</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">3071</span>     <span class="n">renderer</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">artists</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">suppressComposite</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3073</span> <span class="n">renderer</span><span class="o">.</span><span class="n">close_group</span><span class="p">(</span><span class="s1">&#39;axes&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3074</span> <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">False</span>

<span class="nn">File /opt/homebrew/lib/python3.10/site-packages/matplotlib/image.py:132,</span> in <span class="ni">_draw_list_compositing_images</span><span class="nt">(renderer, parent, artists, suppress_composite)</span>
<span class="g g-Whitespace">    </span><span class="mi">130</span> <span class="k">if</span> <span class="n">not_composite</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">has_images</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">131</span>     <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">artists</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">132</span>         <span class="n">a</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">133</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">134</span>     <span class="c1"># Composite any adjacent images together</span>
<span class="g g-Whitespace">    </span><span class="mi">135</span>     <span class="n">image_group</span> <span class="o">=</span> <span class="p">[]</span>

<span class="nn">File /opt/homebrew/lib/python3.10/site-packages/matplotlib/artist.py:72,</span> in <span class="ni">allow_rasterization.&lt;locals&gt;.draw_wrapper</span><span class="nt">(artist, renderer)</span>
<span class="g g-Whitespace">     </span><span class="mi">69</span>     <span class="k">if</span> <span class="n">artist</span><span class="o">.</span><span class="n">get_agg_filter</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">70</span>         <span class="n">renderer</span><span class="o">.</span><span class="n">start_filter</span><span class="p">()</span>
<span class="ne">---&gt; </span><span class="mi">72</span>     <span class="k">return</span> <span class="n">draw</span><span class="p">(</span><span class="n">artist</span><span class="p">,</span> <span class="n">renderer</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">73</span> <span class="k">finally</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">74</span>     <span class="k">if</span> <span class="n">artist</span><span class="o">.</span><span class="n">get_agg_filter</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

<span class="nn">File /opt/homebrew/lib/python3.10/site-packages/mpl_toolkits/mplot3d/art3d.py:272,</span> in <span class="ni">Line3D.draw</span><span class="nt">(self, renderer)</span>
<span class="g g-Whitespace">    </span><span class="mi">270</span> <span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">zs</span> <span class="o">=</span> <span class="n">proj3d</span><span class="o">.</span><span class="n">proj_transform</span><span class="p">(</span><span class="n">xs3d</span><span class="p">,</span> <span class="n">ys3d</span><span class="p">,</span> <span class="n">zs3d</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">M</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">271</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">272</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">273</span> <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">False</span>

<span class="nn">File /opt/homebrew/lib/python3.10/site-packages/matplotlib/artist.py:72,</span> in <span class="ni">allow_rasterization.&lt;locals&gt;.draw_wrapper</span><span class="nt">(artist, renderer)</span>
<span class="g g-Whitespace">     </span><span class="mi">69</span>     <span class="k">if</span> <span class="n">artist</span><span class="o">.</span><span class="n">get_agg_filter</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">70</span>         <span class="n">renderer</span><span class="o">.</span><span class="n">start_filter</span><span class="p">()</span>
<span class="ne">---&gt; </span><span class="mi">72</span>     <span class="k">return</span> <span class="n">draw</span><span class="p">(</span><span class="n">artist</span><span class="p">,</span> <span class="n">renderer</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">73</span> <span class="k">finally</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">74</span>     <span class="k">if</span> <span class="n">artist</span><span class="o">.</span><span class="n">get_agg_filter</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

<span class="nn">File /opt/homebrew/lib/python3.10/site-packages/matplotlib/lines.py:801,</span> in <span class="ni">Line2D.draw</span><span class="nt">(self, renderer)</span>
<span class="g g-Whitespace">    </span><span class="mi">798</span>         <span class="n">gc</span><span class="o">.</span><span class="n">set_foreground</span><span class="p">(</span><span class="n">lc_rgba</span><span class="p">,</span> <span class="n">isRGBA</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">800</span>         <span class="n">gc</span><span class="o">.</span><span class="n">set_dashes</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_dash_pattern</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">801</span>         <span class="n">renderer</span><span class="o">.</span><span class="n">draw_path</span><span class="p">(</span><span class="n">gc</span><span class="p">,</span> <span class="n">tpath</span><span class="p">,</span> <span class="n">affine</span><span class="o">.</span><span class="n">frozen</span><span class="p">())</span>
<span class="g g-Whitespace">    </span><span class="mi">802</span>         <span class="n">gc</span><span class="o">.</span><span class="n">restore</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">804</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_marker</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_markersize</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>

<span class="nn">File /opt/homebrew/lib/python3.10/site-packages/matplotlib/backends/backend_agg.py:132,</span> in <span class="ni">RendererAgg.draw_path</span><span class="nt">(self, gc, path, transform, rgbFace)</span>
<span class="g g-Whitespace">    </span><span class="mi">130</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">131</span>     <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">132</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_renderer</span><span class="o">.</span><span class="n">draw_path</span><span class="p">(</span><span class="n">gc</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">transform</span><span class="p">,</span> <span class="n">rgbFace</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">133</span>     <span class="k">except</span> <span class="ne">OverflowError</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">134</span>         <span class="n">cant_chunk</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

<span class="ne">KeyboardInterrupt</span>: 
</pre></div>
</div>
<img alt="../_images/230e413a80f623827c95f8561ef93b4a7de1acbdfd780b5cf358c0e23741bbb2.png" src="../_images/230e413a80f623827c95f8561ef93b4a7de1acbdfd780b5cf358c0e23741bbb2.png" />
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Chapters"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Chapter7.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Introduction</p>
      </div>
    </a>
    <a class="right-next"
       href="Chapter9.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Introduction</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Introduction</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#the-importance-of-being-nonlinear">The Importance of being Nonlinear</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#flows-on-the-line">Flows on the Line</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fixed-points-and-stability">Fixed Points and Stability</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-8-1-find-all-the-fixed-points-for-dot-x-x-2-1-and-classify-their-stability">Example 8.1: Find all the fixed points for <span class="math notranslate nohighlight">\(\dot{x} = x^2 -1\)</span>, and classify their stability.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-stability-analysis">Linear Stability Analysis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-8-2-use-linearization-to-determine-the-stability-of-the-fixed-points-for-dot-x-sin-x">Example 8.2: Use linearization to determine the stability of the fixed points for <span class="math notranslate nohighlight">\(\dot{x} = \sin x\)</span>.</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#two-dimensional-systems">Two-Dimensional Systems</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#d-linear-systems">2D Linear Systems</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-8-3-analysis-of-the-simple-harmonic-oscillator">Example 8.3: Analysis of the Simple Harmonic Oscillator.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#classification-of-linear-systems">Classification of Linear Systems</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-8-4-solve-the-initial-value-problem-dot-x-x-y-dot-y-4-x-2y-with-initial-condition-x-0-y-0-2-3">Example 8.4: Solve the initial value problem <span class="math notranslate nohighlight">\(\dot{x} = x + y\)</span>, <span class="math notranslate nohighlight">\(\dot{y} = 4 x - 2y\)</span> with initial condition <span class="math notranslate nohighlight">\((x_0, y_0) = (2,-3)\)</span>.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-phase-plane-and-phase-portraits">The Phase Plane and Phase Portraits</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fixed-points-and-linearization">Fixed Points and Linearization</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-8-5-consider-the-system-dot-x-x-e-y-and-dot-y-y-first-use-qualitative-arguments-to-obtain-information-about-the-phase-portrait-then-use-the-runge-kutta-method-to-compute-several-trajectories-and-plot-them-on-the-phase-plane">Example 8.5: Consider the system <span class="math notranslate nohighlight">\(\dot{x} = x + e^{-y}\)</span> and <span class="math notranslate nohighlight">\(\dot{y} = -y\)</span>. First use qualitative arguments to obtain information about the phase portrait. Then, use the Runge-Kutta method to compute several trajectories, and plot them on the phase plane.</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#the-lorenz-equations-and-chaos">The Lorenz Equations and Chaos</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simple-properties-of-the-lorenz-equations">Simple Properties of the Lorenz Equations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-stability-of-the-origin">Linear Stability of the Origin</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-8-1-chaos-on-a-strange-attractor">Exercise 8.1: Chaos on a Strange Attractor</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-definition-of-chaos">The Definition of Chaos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lorenz-attractor-animation">Lorenz Attractor Animation</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Andreas Papaefstathiou
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>