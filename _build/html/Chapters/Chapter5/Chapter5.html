
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>5. Monte Carlo Methods &#8212; Computational Physics I (PHYS 3500K)</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Chapters/Chapter5/Chapter5';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="6. Matrix Computing, Trial-and-Error Searching and Data Fitting" href="../Chapter6/Chapter6.html" />
    <link rel="prev" title="4. Numerical Differentiation and Integration" href="../Chapter4/Chapter4.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/d2lbanner2.png" class="logo__image only-light" alt="Computational Physics I (PHYS 3500K) - Home"/>
    <script>document.write(`<img src="../../_static/d2lbanner2.png" class="logo__image only-dark" alt="Computational Physics I (PHYS 3500K) - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Computational Physics I - PHYS 3500K
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Chapter1/Chapter1.html">1. Hello Whimsical World of Pythonic Physics!</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chapter2/Chapter2.html">2. To err is human, to really foul things up requires a computer!</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chapter3/Chapter3.html">3. Randomness and Random Walks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chapter4/Chapter4.html">4. Numerical Differentiation and Integration</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">5. Monte Carlo Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chapter6/Chapter6.html">6. Matrix Computing, Trial-and-Error Searching and Data Fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chapter7/Chapter7.html">7. Ordinary Differential Equations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chapter8/Chapter8.html">8. An Introduction to Nonlinear Dynamics and Chaos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chapter9/Chapter9.html">9. Boundary Value and Eigenvalue Problems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chapter10/Chapter10.html">10. Partial Differential Equations</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FChapters/Chapter5/Chapter5.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/Chapters/Chapter5/Chapter5.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Monte Carlo Methods</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">5.1. Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-basic-monte-carlo-strategy">5.2. The Basic Monte Carlo Strategy</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-5-1-monte-carlo-integration-example">5.3. Example 5.1: Monte Carlo Integration Example</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-5-2-monte-carlo-error-scaling">5.4. Example 5.2: Monte Carlo Error Scaling</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#variance-reduction">5.5. Variance Reduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-5-3-monte-carlo-integration-with-variance-reduction">5.6. Example 5.3: Monte Carlo Integration with Variance Reduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#multi-dimensional-monte-carlo-integration">5.7. Multi-Dimensional Monte Carlo Integration</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-5-4-the-value-of-through-monte-carlo-integration">5.8. Example 5.4: The value of π through Monte Carlo Integration</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#von-neumann-rejection-sampling-hit-or-miss">5.9. von Neumann Rejection Sampling (“Hit-or-Miss”)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-5-5-von-neumann-rejection">5.9.1. Example 5.5: von Neumann Rejection</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#an-introduction-to-monte-carlo-simulations">5.10. An Introduction to Monte Carlo Simulations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-5-6-gaussian-monte-carlo-events">5.10.1. Example 5.6: Gaussian Monte Carlo Events</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="monte-carlo-methods">
<h1><span class="section-number">5. </span>Monte Carlo Methods<a class="headerlink" href="#monte-carlo-methods" title="Link to this heading">#</a></h1>
<section id="introduction">
<h2><span class="section-number">5.1. </span>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h2>
<p>In physics we are often interested in systems with large degrees of freedom, e.g.:</p>
<ul class="simple">
<li><p>many atoms in a chunk of matter,</p></li>
<li><p>many electrons in an atom,</p></li>
<li><p>the infinitely-many values of a quantum field at all points in a region of space-time.</p></li>
</ul>
<p>The description of such systems often involves the evaluation of integrals of very high dimension.</p>
<p>For example, imagine that we need to integrate atomic wave functions over the three coordinates of each of the 12 electrons in a magnesium atom. This amounts to 3x12=36 dimensions!</p>
<p>If we use 64 points for each integration, this requires about <span class="math notranslate nohighlight">\(64^{36} \simeq 10^{65}\)</span> evaluations of the integrand. If you had a very fast computer, capable of <span class="math notranslate nohighlight">\(10^6\)</span> evaluations per second, this would take <span class="math notranslate nohighlight">\(10^{59}\)</span> s, which is significantly longer than the age of the universe! (<span class="math notranslate nohighlight">\(\sim 10^{17}\)</span> s).</p>
<p>Direct quadrature is hopeless, if you still want to be alive when your integration is done!</p>
<p>Monte Carlo methods provide a way to efficiently evaluating integrals of high dimension.</p>
<p>“Monte Carlo”: arises from the random or “chance” character of the method, through the famous casino in Monaco.</p>
<p><strong>Basic idea</strong>: evaluate the integrand at a representative random sample of points. Analogous to predicting the results of an election on the basis of a poll of a small number of voters.</p>
<p>It turns out that the Monte Carlo strategy is very appropriate for a broad class of problems in statistical and quantum mechanics.</p>
</section>
<section id="the-basic-monte-carlo-strategy">
<h2><span class="section-number">5.2. </span>The Basic Monte Carlo Strategy<a class="headerlink" href="#the-basic-monte-carlo-strategy" title="Link to this heading">#</a></h2>
<p>Even though the real power of Monte Carlo methods (henceforth: MC) is in evaluating multi-dimensional integrals, it is easiest to illustrate the basic ideas in a one-dimensional situation.</p>
<p>Suppose we have to evaluate the integral:</p>
<p><span class="math notranslate nohighlight">\(I = \int_0^1 f(x) \mathrm{d} x\)</span>.</p>
<p>In Chapter 4, we discussed several quadrature formulas that used values of <span class="math notranslate nohighlight">\(f\)</span> at particular values of <span class="math notranslate nohighlight">\(x\)</span>, e.g. equally-spaced for the trapezium and Simpson’s rule.</p>
<p>An alternative way of evaluating the integral is to think of it as the average of <span class="math notranslate nohighlight">\(f\)</span> over the interval <span class="math notranslate nohighlight">\([0,1]\)</span>:</p>
<p><span class="math notranslate nohighlight">\(I \approx \frac{1}{N} \sum_{i=1}^N f(x_i)\)</span>.</p>
<p>Here, the average of <span class="math notranslate nohighlight">\(f\)</span> is evaluated by considering its values at <span class="math notranslate nohighlight">\(N\)</span> points <span class="math notranslate nohighlight">\(x_i\)</span>, chosen at random, with equal probability anywhere within the interval <span class="math notranslate nohighlight">\([0,1]\)</span> (i.e. uniformly).</p>
<p>To estimate the uncertainty associated with this formula, <span class="math notranslate nohighlight">\(\sigma_I\)</span>, consider <span class="math notranslate nohighlight">\(f_i \equiv f(x_i)\)</span> as a random variable, and invoke the central limit theorem for large <span class="math notranslate nohighlight">\(N\)</span>. From the usual laws of statistics, we then have:</p>
<p><span class="math notranslate nohighlight">\(\sigma_I^2 \approx \frac{1}{N} \sigma_f^2 = \frac{1}{N} \left[ \frac{1}{N} \sum_{i=1}^N f_i^2 - \left( \frac{1}{N} \sum_{i=1}^N f_i \right)^2 \right]\)</span></p>
<p>where <span class="math notranslate nohighlight">\(\sigma_f^2\)</span> is the “variance” in <span class="math notranslate nohighlight">\(f\)</span>, i.e. a measure of the extent to which <span class="math notranslate nohighlight">\(f\)</span> deviates from its average value over the region of integration.</p>
<p>Some important aspects of Monte Carlo integration are revealed by the above integration formula:</p>
<ul class="simple">
<li><p>The uncertainty in the estimate of the integral, <span class="math notranslate nohighlight">\(\sigma_I\)</span>, decreases as <span class="math notranslate nohighlight">\(1/\sqrt{N}\)</span>. If more points are used, we will get a more precise answer, although the error decreases very slowly with the number of points: you need to do four times more numerical work to halve the error in your answer!</p></li>
<li><p>The trapezium rule error scales as <span class="math notranslate nohighlight">\(1/N^2\)</span>, therefore having a much greater accuracy for a given amount of numerical work. This advantage vasnishes in the multi-dimensional case, as we will see shortly.</p></li>
<li><p>The precision is greater if <span class="math notranslate nohighlight">\(\sigma_f\)</span> is smaller: i.e. if <span class="math notranslate nohighlight">\(f\)</span> is as smooth as possible. One limit to consider is that when <span class="math notranslate nohighlight">\(f\)</span> is constant, in which case we need its value only at one point to define its average. In the other limit, consider a situation in which <span class="math notranslate nohighlight">\(f\)</span> is zero everywhere, except for a very narrow peak above some value of <span class="math notranslate nohighlight">\(x\)</span>. Then, if we pick <span class="math notranslate nohighlight">\(x_i\)</span>s with an equal probability in <span class="math notranslate nohighlight">\([0,1]\)</span>, it is probable that all but a few of them will lie outside the peak of <span class="math notranslate nohighlight">\(f\)</span>, and this will lead to a poor estimate of <span class="math notranslate nohighlight">\(I\)</span>.</p></li>
</ul>
<p>The method is extended to any interval <span class="math notranslate nohighlight">\([a,b]\)</span>, by choosing random, uniform <span class="math notranslate nohighlight">\(x_i\)</span>s in <span class="math notranslate nohighlight">\([a,b]\)</span> and:</p>
<p><span class="math notranslate nohighlight">\(I = \int_a^b f(x) \mathrm{d} x = \frac{b-a}{N} \sum_{i=1}^N f(x_i)\)</span>.</p>
<p>Let’s begin our numerical Monte Carlo work by evaluating the integral:</p>
<p><span class="math notranslate nohighlight">\(\int_0^1 \frac{ \mathrm{d} x } { 1 + x^2 } = \frac{\pi}{4}\)</span>.</p>
<p>Let’s also calculate the error using the formula for <span class="math notranslate nohighlight">\(\sigma_I\)</span>.</p>
</section>
<section id="example-5-1-monte-carlo-integration-example">
<h2><span class="section-number">5.3. </span>Example 5.1: Monte Carlo Integration Example<a class="headerlink" href="#example-5-1-monte-carlo-integration-example" title="Link to this heading">#</a></h2>
<p>Use the Monte Carlo integration method to calculate the integral <span class="math notranslate nohighlight">\(\int_0^1 \frac{ \mathrm{d} x } { 1 + x^2 } = \frac{\pi}{4}\)</span>. Also calculate the error.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">random</span> <span class="c1"># we need random numbers for the Monte Carlo method!</span>

<span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1234</span><span class="p">)</span>

<span class="c1"># Let&#39;s define a function that performs one-dimensional MC integration of an arbitrary for N points</span>
<span class="c1"># We&#39;ll also make it capable of performing the integration in an interval a,b</span>
<span class="k">def</span> <span class="nf">mcint</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>

    <span class="c1"># return I, sigmaI # return the integral and its error</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span>  <span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">line</span> <span class="mi">11</span>
    
    <span class="o">^</span>
<span class="ne">SyntaxError</span>: incomplete input
</pre></div>
</div>
</div>
</div>
</section>
<section id="example-5-2-monte-carlo-error-scaling">
<h2><span class="section-number">5.4. </span>Example 5.2: Monte Carlo Error Scaling<a class="headerlink" href="#example-5-2-monte-carlo-error-scaling" title="Link to this heading">#</a></h2>
<p>For the function of example 5.1, calculate the error as a function of the number of points <span class="math notranslate nohighlight">\(N\)</span>, from <span class="math notranslate nohighlight">\(N=10\)</span> to <span class="math notranslate nohighlight">\(N=10^4\)</span>. Plot the the logarithm of the error versus the log of the number of points. Does it agree with our expectations?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The array of the number of points to integrate over:</span>
<span class="n">Narray</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">5000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="variance-reduction">
<h2><span class="section-number">5.5. </span>Variance Reduction<a class="headerlink" href="#variance-reduction" title="Link to this heading">#</a></h2>
<p>The uncertainty (squared) in a MC quadrature is proportional to the variance of the integrand:</p>
<p><span class="math notranslate nohighlight">\(\sigma_I^2 \approx \frac{1}{N} \sigma_f^2\)</span>,</p>
<p>with the variance of the integrand:</p>
<p><span class="math notranslate nohighlight">\(\sigma_f^2 = \left[ \frac{1}{N} \sum_{i=1}^N f_i^2 - \left( \frac{1}{N} \sum_{i=1}^N f_i \right)^2 \right]\)</span>.</p>
<p>Therefore, if we find a way of reducing the variance of the integrand, we will improve the efficiency of the method. One method is known as “importance sampling”.</p>
<p>Let’s imagine multiplying and dividing the integrand by a positive weight function <span class="math notranslate nohighlight">\(w(x)\)</span>, normalized such that:</p>
<p><span class="math notranslate nohighlight">\(\int_0^1 w(x) \mathrm{d} x = 1\)</span>.</p>
<p>The integral can then be written as:</p>
<p>I = <span class="math notranslate nohighlight">\(\int_0^1 w(x) \frac{f (x)} { w(x) } \mathrm{d} x\)</span>.</p>
<p>We can then change variables from <span class="math notranslate nohighlight">\(x\)</span> to:</p>
<p><span class="math notranslate nohighlight">\(y(x) = \int_0^x w(x') \mathrm{d}x'\)</span>.</p>
<p>This implies that:</p>
<p><span class="math notranslate nohighlight">\(\frac{ \mathrm{d} y } { \mathrm{d} x } = w(x)\)</span> and <span class="math notranslate nohighlight">\(y(x=0)=0\)</span>, <span class="math notranslate nohighlight">\(y(x=1)=1\)</span>.</p>
<p>and after the change of variables, the integral becomes:</p>
<p><span class="math notranslate nohighlight">\(I = \int_0^1 \frac{ f(x(y)) } { w(x(y)) } \mathrm{d} y\)</span>.</p>
<p>The MC integration proceeds as usual, i.e. averaging the values of <span class="math notranslate nohighlight">\(f/w\)</span> using random and uniform points <span class="math notranslate nohighlight">\(y\)</span> over the interval <span class="math notranslate nohighlight">\([0,1]\)</span>:</p>
<p><span class="math notranslate nohighlight">\(I \approx \frac{1}{N} \sum_{i=1}^N \frac{ f(x(y_i)) } { w(x(y_i)) }\)</span>.</p>
<p>If we choose a <span class="math notranslate nohighlight">\(w\)</span> function that behaves approximately as <span class="math notranslate nohighlight">\(f\)</span>, i.e. it is large where <span class="math notranslate nohighlight">\(f\)</span> is large and small where <span class="math notranslate nohighlight">\(f\)</span> is small, then the integrand <span class="math notranslate nohighlight">\(f/w\)</span> can be made very smooth.
This will result in a reduction in the variance of the MC estimate.</p>
<p>This implies of course that we are able to find an appropriate <span class="math notranslate nohighlight">\(w\)</span> and that we are able to invert <span class="math notranslate nohighlight">\(y(x) = \int_0^x w(x') \mathrm{d}x'\)</span> to find <span class="math notranslate nohighlight">\(x(y)\)</span>.</p>
<p>As an example, let’s consider the same integral, <span class="math notranslate nohighlight">\(I = \int_0^1 \frac{\mathrm{d}x}{1+x^2}\)</span>. A good choice for a weight function is:</p>
<p><span class="math notranslate nohighlight">\(w(x) = \frac{1}{3} (4 - 2 x)\)</span>.</p>
<p>This is positive definite, decreases monotonically and is normalized correctly: <span class="math notranslate nohighlight">\(\int_0^1 w(x) \mathrm{d}x = 1\)</span>. It also approximates well the behavior of <span class="math notranslate nohighlight">\(f\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span> <span class="c1"># import matplotlib, a conventional module name is plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Now plot! Don&#39;t forget the different labels! </span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span> <span class="c1"># create the elements required for matplotlib. This creates a figure containing a single axes.</span>

<span class="c1"># set the labels and titles:</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> <span class="c1"># set the x label</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Function&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> <span class="c1"># set the y label. Note that the &#39;r&#39; is necessary to remove the need for double slashes. You can use LaTeX! </span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Function comparison&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span> <span class="c1"># set the title </span>

<span class="c1"># construct the x variable: </span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span>

<span class="c1"># make a one-dimensional plot:</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$f(x) = 1/(x^2 + 1)$&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span> 

<span class="c1"># check if this agrees with a line with slope -1/2 (on the log-log plot):</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$w(x) = (4-2x)/3$&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

<span class="c1"># construct the legend:</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper center&#39;</span><span class="p">)</span>  <span class="c1"># Add a legend</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> <span class="c1"># show the plot here</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/170a1ae558178682e43ccfc956a180e246f92a8135eb130a7fa050f9cdb67d38.png" src="../../_images/170a1ae558178682e43ccfc956a180e246f92a8135eb130a7fa050f9cdb67d38.png" />
</div>
</div>
<p>The new integration variable is:</p>
<p><span class="math notranslate nohighlight">\(y = \int_0^x w(x') \mathrm{d} x' = \frac{1}{3} x(4-x)\)</span>.</p>
<p>And this can be inverted to give:</p>
<p><span class="math notranslate nohighlight">\(x = 2 - (4 - 3y)^{1/2}\)</span>.</p>
<p>Let’s see this change of variables in action!</p>
</section>
<section id="example-5-3-monte-carlo-integration-with-variance-reduction">
<h2><span class="section-number">5.6. </span>Example 5.3: Monte Carlo Integration with Variance Reduction<a class="headerlink" href="#example-5-3-monte-carlo-integration-with-variance-reduction" title="Link to this heading">#</a></h2>
<p>Use the Monte Carlo integration method with the variance reduction to calculate the integral <span class="math notranslate nohighlight">\(\int_0^1 \frac{ \mathrm{d} x } { 1 + x^2 }\)</span> over the same number of points as in Example 5.2. Make a plot comparing to the error calculated in Example 5.2.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Start by modifying the mcint function to accept the x(y) and w(x) functions as input</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">random</span> <span class="c1"># we need random numbers for the Monte Carlo method!</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The MC integral of f(x) = 1/(1+x^2) in [0,1] for N=1E4 points is= 0.784742361698107 +- 0.0015987488463171692
The MC integral with variance reduction 0.7855334063802001 +- 0.0001698120319239752
The analytic value of the integral is= 0.7853981633974483
</pre></div>
</div>
</div>
</div>
</section>
<section id="multi-dimensional-monte-carlo-integration">
<h2><span class="section-number">5.7. </span>Multi-Dimensional Monte Carlo Integration<a class="headerlink" href="#multi-dimensional-monte-carlo-integration" title="Link to this heading">#</a></h2>
<p>The one-dimensional discussion above can be readily generalized to <span class="math notranslate nohighlight">\(d\)</span>-dimensional integrals of the form:</p>
<p><span class="math notranslate nohighlight">\(I = \int \mathrm{d}^d x f(\vec{x})\)</span>.</p>
<p>MC integration proceeds as it did in the one-dimensional case:</p>
<p><span class="math notranslate nohighlight">\(I \approx \frac{1}{N} \sum_{i=1}^N f(\vec{x}_i)\)</span>,</p>
<p>where the components of the vector <span class="math notranslate nohighlight">\(\vec{x}_i\)</span> are chosen independently.</p>
<p>Let’s use this method to calculate <span class="math notranslate nohighlight">\(\pi\)</span> via:</p>
<p><span class="math notranslate nohighlight">\(\pi = 4 \int_0^1 \mathrm{d} y \int_0^1 \mathrm{d} x \theta(1 - x^2 - y^2)\)</span>,</p>
<p>i.e. by comparing the area of a quadrant of the unit circle, to that of the unit square.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span> <span class="c1"># import matplotlib, a conventional module name is plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Now plot! Don&#39;t forget the different labels! </span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span> <span class="c1"># create the elements required for matplotlib. This creates a figure containing a single axes.</span>

<span class="c1"># set the labels and titles:</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> <span class="c1"># set the x label</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$y$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> <span class="c1"># set the y label. Note that the &#39;r&#39; is necessary to remove the need for double slashes. You can use LaTeX! </span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Area of quadrant of cirlce vs. that of square of side 1&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span> <span class="c1"># set the title </span>

<span class="c1"># plot the circle</span>
<span class="n">circle1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Circle</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">circle1</span><span class="p">)</span>

<span class="c1"># set the aspect ratio of the axes to 1:</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> <span class="c1"># show the plot here</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/0d654e36fba1ba962b1c41d5b0c1cc5ae30ec865f2acfa2a031efc55ca151b37.png" src="../../_images/0d654e36fba1ba962b1c41d5b0c1cc5ae30ec865f2acfa2a031efc55ca151b37.png" />
</div>
</div>
</section>
<section id="example-5-4-the-value-of-through-monte-carlo-integration">
<h2><span class="section-number">5.8. </span>Example 5.4: The value of π through Monte Carlo Integration<a class="headerlink" href="#example-5-4-the-value-of-through-monte-carlo-integration" title="Link to this heading">#</a></h2>
<p>Use multi-dimensional Monte Carlo integration to calculate π!</p>
<p>We can also use variance reduction in many dimensions. For a weight function <span class="math notranslate nohighlight">\(w(\vec{x})\)</span> normalized so that its integral over the region is unity, the new variable is a vector <span class="math notranslate nohighlight">\(\vec{y}\)</span>, where the <em>Jacobian</em> is:</p>
<p><span class="math notranslate nohighlight">\(\left| \frac{\partial \vec{y}}{\partial \vec{x}}\right| = w(\vec{x})\)</span>.</p>
<p>It’s generally very difficult to construct <span class="math notranslate nohighlight">\(\vec{x}(\vec{y})\)</span> explicitly. We will discuss methods to do this below.</p>
<p>Going back to our MC integration results, although the results were satisfactory in our examples, MC integration does not appear to be particularly efficient, especially in comparison to the other quadrature methods that we previously discussed.</p>
<p>However, consider evaluating a multi-dimensional integral, such as the one used for the calculation of <span class="math notranslate nohighlight">\(\pi\)</span>.</p>
<p>Suppose that we are willing to invest a given amount of numerical work, e.g. to evaluate the integrand exactly <span class="math notranslate nohighlight">\(N\)</span> times, and we wish to compare the efficiencies of various quadrature methods.</p>
<p>For the trapezium rule, for example, if there are a total of <span class="math notranslate nohighlight">\(N\)</span> points, then each dimension of a <span class="math notranslate nohighlight">\(d\)</span>-dimensional integral is broken up into <span class="math notranslate nohighlight">\(\sim N^{1/d}\)</span> intervals, of spacing <span class="math notranslate nohighlight">\(h\sim N^{-1/d}\)</span>. It turns out that the total error would be:</p>
<p><span class="math notranslate nohighlight">\(\epsilon_\mathrm{trapezium} \sim \mathcal{O}(1/N^{2/d})\)</span>.</p>
<p>For large <span class="math notranslate nohighlight">\(d\)</span>, this decreases very slowly with increasing <span class="math notranslate nohighlight">\(N\)</span>. For example, for <span class="math notranslate nohighlight">\(d=4\)</span>, it decreases as <span class="math notranslate nohighlight">\(\sim \mathcal{O}(1/N^{1/2})\)</span>.</p>
<p>On the other hand, the uncertainty of Monte Carlo quadrature always decreases as <span class="math notranslate nohighlight">\(\sim 1/\sqrt{N}\)</span>, <em>independent</em> of the number of dimensions <span class="math notranslate nohighlight">\(d\)</span>!</p>
<p>Therefore, we would expect that the MC method is more efficient when <span class="math notranslate nohighlight">\(d\simeq 4\)</span>.</p>
</section>
<section id="von-neumann-rejection-sampling-hit-or-miss">
<h2><span class="section-number">5.9. </span>von Neumann Rejection Sampling (“Hit-or-Miss”)<a class="headerlink" href="#von-neumann-rejection-sampling-hit-or-miss" title="Link to this heading">#</a></h2>
<p>During our integration of <span class="math notranslate nohighlight">\(I = \int_0^1 \frac{1}{1+x^2} \mathrm{d} x\)</span>, if we had wanted to use the weight function:</p>
<p><span class="math notranslate nohighlight">\(w(x) = \frac{6}{5} (1 - \frac{1}{2} x^2)\)</span>,</p>
<p>then we would have been faced with solving a cubic equation to find <span class="math notranslate nohighlight">\(x(y)\)</span>. While this is certainly possible, choices of the weight that might follow <span class="math notranslate nohighlight">\(f\)</span> more generally will lead to more complicated functions that cannot be inverted analytically.</p>
<p>However, it is possible to do this numerically. A convenient method for generating one- or multi-dimensional random variables is the von Neumann rejection:</p>
<p>Suppose we are interested in generating <span class="math notranslate nohighlight">\(x\)</span> in <span class="math notranslate nohighlight">\([0,1]\)</span> with distribution <span class="math notranslate nohighlight">\(w(x)\)</span>, and that <span class="math notranslate nohighlight">\(w'(x)\)</span> is a positive function such that <span class="math notranslate nohighlight">\(w'(x) &gt; w(x)\)</span> over the region of integration. A convenient choice (but not always useful) for <span class="math notranslate nohighlight">\(w'\)</span> is any constant greater than the maximum value of <span class="math notranslate nohighlight">\(w\)</span> in the region of integration.</p>
<p>If we generate points in two dimensions that uniformly fill the area under the curve <span class="math notranslate nohighlight">\(w'(x)\)</span> and then “accept” for use only those points that are under <span class="math notranslate nohighlight">\(w(x)\)</span>, then the accepted points will be distributed according to <span class="math notranslate nohighlight">\(w(x)\)</span>.</p>
<p>Practically:</p>
<ul class="simple">
<li><p>Choose <span class="math notranslate nohighlight">\(x_i\)</span> distributed proportional to <span class="math notranslate nohighlight">\(w'\)</span>,</p></li>
<li><p>Choose a random number <span class="math notranslate nohighlight">\(\eta\)</span> uniformly in <span class="math notranslate nohighlight">\([0,1]\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(x_i\)</span> is then accepted if <span class="math notranslate nohighlight">\(\eta &lt; w(x_i)/w'(x_i)\)</span>.</p></li>
<li><p>if a point is rejected, we simply go on and try another <span class="math notranslate nohighlight">\(x_i\)</span>.</p></li>
</ul>
<p>This technique is clearly efficient only if <span class="math notranslate nohighlight">\(w'\)</span> is close to <span class="math notranslate nohighlight">\(w\)</span> throughout the entire range of integration, otherwise too much time is wasted rejecting “useless” points.</p>
<section id="example-5-5-von-neumann-rejection">
<h3><span class="section-number">5.9.1. </span>Example 5.5: von Neumann Rejection<a class="headerlink" href="#example-5-5-von-neumann-rejection" title="Link to this heading">#</a></h3>
<p>Use von Neumann rejection to sample points in the interval <span class="math notranslate nohighlight">\([0,1]\)</span>, distributed as <span class="math notranslate nohighlight">\(w(x) = \frac{6}{5} ( 1 - \frac{1}{2} x^2)\)</span>. Plot a histogram of the points and verify that they are indeed distributed according to <span class="math notranslate nohighlight">\(w(x)\)</span>. Evaluate the integral <span class="math notranslate nohighlight">\(I = \int_0^1 \frac{1}{1+x^2} \mathrm{d} x\)</span> and its uncertainty with these points.</p>
</section>
</section>
<section id="an-introduction-to-monte-carlo-simulations">
<h2><span class="section-number">5.10. </span>An Introduction to Monte Carlo Simulations<a class="headerlink" href="#an-introduction-to-monte-carlo-simulations" title="Link to this heading">#</a></h2>
<p>A Monte Carlo simulation contains the following ingredients:</p>
<ul class="simple">
<li><p>A probability density function that characterizes the system that we wish to simulate,</p></li>
<li><p>Random numbers,</p></li>
<li><p>A sampling rule,</p></li>
<li><p>An error estimation.</p></li>
</ul>
<p>The von Neumann rejection method of sampling provides a simple way to generate “simulations”, i.e. samples of “events” that are distributed according to a certain probability density function, and look “realistic”.</p>
<p>Let’s examine an example in one dimension!</p>
<p>Example 5.5: Due to the uncertainty principle, the mass, <span class="math notranslate nohighlight">\(m\)</span> of an unstable particle (which can be measured through the momenta of its decay products), is distributed according to the Breit-Wigner distribution (in natural units):</p>
<p><span class="math notranslate nohighlight">\(f(m) = \frac{k}{ (m^2 - M^2)^2 + \Gamma^2 M^2 }\)</span>,</p>
<p>where <span class="math notranslate nohighlight">\(k\)</span> is a normalization constant, <span class="math notranslate nohighlight">\(M\)</span> is the particle’s “nominal” mass and, <span class="math notranslate nohighlight">\(\Gamma = 1/\tau\)</span> is its width, defined as the inverse of its lifetime, <span class="math notranslate nohighlight">\(\tau\)</span>.</p>
<p>Our goal is to generate <span class="math notranslate nohighlight">\(N\)</span> decays of the particle in its rest frame, distributed according to the Breit-Wigner distribution.</p>
<p>We can assume that the particle is a top quark, with nominal mass <span class="math notranslate nohighlight">\(M = 172.7\)</span> GeV and width <span class="math notranslate nohighlight">\(\Gamma = 1.4\)</span> GeV.</p>
<p>We can use the von Neumann rejection method. To do so, we need to find a constant which is larger than <span class="math notranslate nohighlight">\(f(m)\)</span> everywhere. We can start by choosing <span class="math notranslate nohighlight">\(f_\mathrm{max}= \frac{k}{ \Gamma^2 M^2 }\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">math</span>

<span class="c1"># first let&#39;s define our distribution: </span>
<span class="k">def</span> <span class="nf">fBW</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">Gam</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the Breit-Wigner distribution&quot;&quot;&quot;</span>
    <span class="n">k</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># set the normalization constant to 1</span>
    <span class="k">return</span> <span class="n">k</span> <span class="o">/</span> <span class="p">((</span> <span class="n">m</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">M</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Gam</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">M</span><span class="o">**</span><span class="mi">2</span> <span class="p">)</span>

<span class="c1"># and perform the von Neumann rejection:</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">1000</span> <span class="c1"># we will generate N decay &quot;events&quot;</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># n will be the counter of generated &quot;events&quot;</span>
<span class="c1"># set the properties of the particle:</span>
<span class="n">M</span> <span class="o">=</span> <span class="mf">172.7</span>
<span class="n">Gam</span> <span class="o">=</span> <span class="mi">14</span>
<span class="c1"># let&#39;s also set a minimum and maximum mass (in GeV) </span>
<span class="n">mmax</span> <span class="o">=</span> <span class="mi">200</span> 
<span class="n">mmin</span> <span class="o">=</span> <span class="mi">150</span>
<span class="c1"># and save the generated masses in an array:</span>
<span class="n">masses</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">while</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="n">N</span><span class="p">:</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span><span class="o">*</span><span class="p">(</span><span class="n">mmax</span><span class="o">-</span><span class="n">mmin</span><span class="p">)</span> <span class="o">+</span> <span class="n">mmin</span>  
    <span class="n">r</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="n">fBW</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">Gam</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">Gam</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">M</span><span class="o">**</span><span class="mi">2</span><span class="p">):</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">masses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">pass</span>    
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s plot a histogram of the masses!</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span> <span class="c1"># import matplotlib, a conventional module name is plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span> <span class="c1"># create the elements required for matplotlib. This creates a figure containing a single axes.</span>

<span class="c1"># set the labels and titles:</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$m$ [GeV]&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> <span class="c1"># set the x label</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;frequency&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> <span class="c1"># set the y label</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Breit-Wigner for a top quark&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span> <span class="c1"># set the title </span>

<span class="c1"># make one-dimensional plots using the above arrays, add a custom label, linestyles and colors:</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">masses</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;step&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;von Neumann&quot;</span><span class="p">)</span> 

<span class="c1"># construct the legend:</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>  <span class="c1"># Add a legend</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> <span class="c1"># show the plot here</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/b8cb4c1311e05d89e8ba761041cae02dc79e154864203775fe75712fa13e5e74.png" src="../../_images/b8cb4c1311e05d89e8ba761041cae02dc79e154864203775fe75712fa13e5e74.png" />
</div>
</div>
<p>In this case, we can perform a change of variables to obtain an efficiency of 100%:</p>
<p><span class="math notranslate nohighlight">\(m^2 = M\Gamma \tan\eta + M^2\)</span>.</p>
<p>and with this:</p>
<p><span class="math notranslate nohighlight">\(\frac{ \mathrm{d} m^2 }{ \mathrm{d} \eta} = M\Gamma \sec^2 \eta\)</span>, which turns the Breit-Wigner distribution flat, e.g., under the integral:</p>
<p><span class="math notranslate nohighlight">\(I = \int_{m_\mathrm{min}}^{m_\mathrm{max}} \mathrm{d} m^2 \frac{k}{ (m^2 - M^2)^2 + \Gamma^2 M^2 }\)</span>,</p>
<p>which turns into:</p>
<p><span class="math notranslate nohighlight">\(I = \int_{m_\mathrm{min}}^{m_\mathrm{max}} \mathrm{d} \eta \left|\frac{ \mathrm{d} m^2 }{ \mathrm{d} \eta}\right|  \frac{k}{ (m^2 - M^2)^2 + \Gamma^2 M^2 } = \int_{\eta_\mathrm{min}}^{\eta_\mathrm{max}} \frac{k}{\Gamma M} \mathrm{d} \rho\)</span>.</p>
<section id="example-5-6-gaussian-monte-carlo-events">
<h3><span class="section-number">5.10.1. </span>Example 5.6: Gaussian Monte Carlo Events<a class="headerlink" href="#example-5-6-gaussian-monte-carlo-events" title="Link to this heading">#</a></h3>
<p>Generate events distributed according to a Gaussian distribution:</p>
<p><span class="math notranslate nohighlight">\(f(x) = \frac{1}{\sigma \sqrt{2 \pi}} \exp(- (x-\mu)^2 / (2\sigma^2))\)</span></p>
<p>Plot the results in a histogram.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">math</span>

<span class="c1"># first let&#39;s define our distribution: </span>
<span class="k">def</span> <span class="nf">Gaussian</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">mu</span><span class="p">,</span><span class="n">sigma</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the Gaussan distribution&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="mi">1</span><span class="o">/</span><span class="n">sigma</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="o">-</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">mu</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">sigma</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>

<span class="c1"># and perform the von Neumann rejection:</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">10000</span> <span class="c1"># we will generate N poits</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># n will be the counter of generated &quot;events&quot;</span>
<span class="c1"># set the properties of the particle:</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mi">1</span>
<span class="c1"># let&#39;s also set a minimum and maximum mass (in GeV) </span>
<span class="n">xmin</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span>
<span class="n">xmax</span> <span class="o">=</span> <span class="mi">10</span>
<span class="c1"># and save the generated masses in an array:</span>
<span class="n">x</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">while</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="n">N</span><span class="p">:</span>
    <span class="n">xi</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span><span class="o">*</span><span class="p">(</span><span class="n">xmax</span><span class="o">-</span><span class="n">xmin</span><span class="p">)</span> <span class="o">+</span> <span class="n">xmin</span>  
    <span class="n">r</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="n">Gaussian</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span><span class="n">mu</span><span class="p">,</span><span class="n">sigma</span><span class="p">)</span><span class="o">/</span> <span class="n">Gaussian</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span><span class="n">mu</span><span class="p">,</span><span class="n">sigma</span><span class="p">):</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">pass</span>    
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span> <span class="c1"># import matplotlib, a conventional module name is plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span> <span class="c1"># create the elements required for matplotlib. This creates a figure containing a single axes.</span>

<span class="c1"># set the labels and titles:</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> <span class="c1"># set the x label</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;frequency&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> <span class="c1"># set the y label</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Gaussian distribution with $\mu=&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">mu</span><span class="p">)</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;$ and $\sigma=&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sigma</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span> <span class="c1"># set the title </span>

<span class="c1"># make one-dimensional plots using the above arrays, add a custom label, linestyles and colors:</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;step&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;von Neumann&quot;</span><span class="p">)</span> 

<span class="c1"># plot the distribution itself:</span>
<span class="n">xv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">gaussianpoints</span> <span class="o">=</span> <span class="n">Gaussian</span><span class="p">(</span><span class="n">xv</span><span class="p">,</span><span class="n">mu</span><span class="p">,</span><span class="n">sigma</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xv</span><span class="p">,</span> <span class="n">gaussianpoints</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Gaussian analytic&#39;</span><span class="p">)</span>

<span class="c1"># construct the legend:</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>  <span class="c1"># Add a legend</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> <span class="c1"># show the plot here</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/233d77fabeaec31b32e798a362d836cf6cecc987faf22f8b7216f35512a68dec.png" src="../../_images/233d77fabeaec31b32e798a362d836cf6cecc987faf22f8b7216f35512a68dec.png" />
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Chapters/Chapter5"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../Chapter4/Chapter4.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">4. </span>Numerical Differentiation and Integration</p>
      </div>
    </a>
    <a class="right-next"
       href="../Chapter6/Chapter6.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">6. </span>Matrix Computing, Trial-and-Error Searching and Data Fitting</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">5.1. Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-basic-monte-carlo-strategy">5.2. The Basic Monte Carlo Strategy</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-5-1-monte-carlo-integration-example">5.3. Example 5.1: Monte Carlo Integration Example</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-5-2-monte-carlo-error-scaling">5.4. Example 5.2: Monte Carlo Error Scaling</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#variance-reduction">5.5. Variance Reduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-5-3-monte-carlo-integration-with-variance-reduction">5.6. Example 5.3: Monte Carlo Integration with Variance Reduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#multi-dimensional-monte-carlo-integration">5.7. Multi-Dimensional Monte Carlo Integration</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-5-4-the-value-of-through-monte-carlo-integration">5.8. Example 5.4: The value of π through Monte Carlo Integration</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#von-neumann-rejection-sampling-hit-or-miss">5.9. von Neumann Rejection Sampling (“Hit-or-Miss”)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-5-5-von-neumann-rejection">5.9.1. Example 5.5: von Neumann Rejection</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#an-introduction-to-monte-carlo-simulations">5.10. An Introduction to Monte Carlo Simulations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-5-6-gaussian-monte-carlo-events">5.10.1. Example 5.6: Gaussian Monte Carlo Events</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Andreas Papaefstathiou
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>